<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Profile-likelihood inference for fitted model objects."><title>Profile-Likelihood Inference for Fitted Parametric Model
Objects — profLik.default • potomax</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Profile-Likelihood Inference for Fitted Parametric Model
Objects — profLik.default"><meta property="og:description" content="Profile-likelihood inference for fitted model objects."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">potomax</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Intro.html">R Package potomax: Overview</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/IRSN/potomax/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Profile-Likelihood Inference for Fitted Parametric Model
Objects</h1>
      <small class="dont-index">Source: <a href="https://github.com/IRSN/potomax/blob/HEAD/R/profLik.R" class="external-link"><code>R/profLik.R</code></a></small>
      <div class="d-none name"><code>profLik.default.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Profile-likelihood inference for fitted model objects.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for default</span></span>
<span><span class="fu"><a href="profLik.html">profLik</a></span><span class="op">(</span><span class="va">object</span>,</span>
<span>        <span class="va">fun</span>,</span>
<span>        level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>        deriv <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        trace <span class="op">=</span> <span class="fl">0</span>,</span>
<span>        diagno <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        ftol_abs <span class="op">=</span> <span class="fl">1e-12</span>, ftol_rel <span class="op">=</span> <span class="fl">1e-8</span>,</span>
<span>        <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>A fitted model object. See <b>Details</b>.</p></dd>


<dt>fun</dt>
<dd><p>A function of the parameter vector for which the
profile-likelihood will be carried over. This function must have
the arguments: <code>theta</code> for the vector of parameters and
<code>object</code> for the model object; so the function can use the
velue of some of slots of <code>object</code> see <b>Details</b>. The
function must return a list with two elements with names
<code>"objective"</code> and <code>"gradient"</code> as required by
<code><a href="https://rdrr.io/pkg/nloptr/man/nloptr.html" class="external-link">nloptr</a></code> see <b>Examples</b>. If needed, a
wrapper function can be used to use more arguments.</p></dd>


<dt>level</dt>
<dd><p>Level of confidence. Can be of length <code>&gt; 1</code>.</p></dd>


<dt>deriv</dt>
<dd><p>Logical. If <code>TRUE</code>, the function <code>fun</code> is
assumed to provide a gradient vector as an attribute named
<code>"gradient"</code> of the result. For now <code>deriv</code> can only be
<code>TRUE</code>, which implies that <code>fun</code> <em>must</em> compute the
gradient.</p></dd>


<dt>trace</dt>
<dd><p>Level of verbosity; the value <code>0</code> prints
nothing.</p></dd>


<dt>diagno</dt>
<dd><p>Logical. When <code>TRUE</code> two diagnostics are
returned as two attributes <code>"diagno"</code> and <code>"theta"</code> of
the returned array. The array in attribute <code>"diagno"</code>
contains the return codes of <code>nloptr</code> (named
<code>"status"</code>), the values of the objective and of the
constraint functions as well as a value named <code>"gradDist"</code>
whcih measures the distance between the two directions of the two
gradients: objective and constraint.  The array in attribute
<code>"theta"</code> contains the value of the Poisson-GP parameter that
was found to maxi/minimise the function <code>fun</code> under the
constraint of a high log-likelihood. See section <b>Note</b>.</p></dd>


<dt>ftol_abs, ftol_rel</dt>
<dd><p>Absolute and relative tolerance to stop
the constrained optimisation <code><a href="https://rdrr.io/pkg/nloptr/man/nloptr.html" class="external-link">nloptr</a></code>. These
apply to the objective of the constrained optimisation that is to
the value of <code>fun</code>. Remind that <code>ftol_abs</code> is thus given
with the same unit as <code>fun</code>.</p></dd>


<dt>...</dt>
<dd><p>Not used yet.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An array with the value of the function and the
corresponding Lower and Upper end-points for the given confidence
levels. This array has two attributes with names <code>"diagno"</code></p>


<p>and <code>"psi"</code> which both are arrays. The attributes provide
information about the numerical optimisation and the values of the
vector of parameter that maximised or minimised the function
<code>fun</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Compute the lower and upper end-points of a
profile-likelihood based confidence interval. The (apparently new)
method used here relies on maximising and minimising the function
of interest, say \(\eta(\boldsymbol(\theta)\),
under the constraint that the log-likelihood is greater than the
maximal log-likelihood minus a positive quantity \(\delta\)
depending on the confidence level. This differs from the usual
method which relies on an univariate zero-finding for the
profile-likelihood function (minus a constant). Remind that each
evaluation of the profile requires a \(p-1\) dimensional
optimisation. As a major advantage, the new method does not
require a re-parameterisation of the model.</p>
<p>The requirement for the method to work is that <code>object</code> has
suitable "slots", i.e. is a list with suitable elements. These
are: the number <code>p</code> of parameters, the vector <code>parNames</code>
of the parameter names, the vector <code>estimate</code> of ML
estimates, the closure <code>negLogLikFun</code> computing the negative
log-likelihood function and the value <code>negLogLik</code> of the
minimised negative log-likelihood. These requirements are
fulfilled for <code><a href="poisGP.html">poisGP</a></code> objects of the package. The
result returned by <code>object$negLogLikFun</code> should have a
<code>"gradient"</code> attribute to allow the use of derivatives.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>For each confidence limit the numerical optimisation may
fail, in which case the limit will be <code>NA</code>. Using <code>trace
= 1</code> can be useful to further check the optimisation. We encourage
the user to inspect the set of important diagnostics returned when
<code>diagno = TRUE</code>, especially those in the attribute of the
result named <code>"diagno"</code>. The <em>optimisation status</em> value
in <code>status</code> should be between <code>1</code> and <code>4</code> to
indicate that small changes on the parameter or on the objective
were eventually obtained. On the other hand, a value of <code>5</code>
for <code>status</code> indicates that the maximal number of iterations
was reached, which is considered here as a failure. Both the
<code>constraint</code> and <code>gradDist</code> values should be small
because the constraint must be active at the optimum and the two
gradients for the objective and the constraint must be colinear at
the optimum (Lagrange conditions). In other words the optimum
parameter vector must lie on the boundary of the high-likelihood
region corresponding to the chosen confidence level.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Deville Y. (2017) "Profile-Likelihood Using Constrained
Optimisation". Unpublished Tech. Report.</p>
<p>Johnson S.G. <em>The NLopt Nonlinear-Optimization Package</em>.
<a href="https://github.com/stevengj/nlopt" class="external-link">https://github.com/stevengj/nlopt</a>.</p>
<p>Section <b>Return values</b> in the manual
<a href="https://nlopt.readthedocs.io/en/latest/NLopt_Reference" class="external-link">NLOPT
Reference</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/nloptr/man/nloptr.html" class="external-link">nloptr</a></code> for details on the
optimisation.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Yves Deville</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">object</span> <span class="op">&lt;-</span> <span class="fu"><a href="poisGP.html">poisGP</a></span><span class="op">(</span><span class="va">Garonne</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'threshold' is missing and set just below the smallest obsevation</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'threshold' is smaller than the smallest observation</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'threshold' is smaller than the smallest observation</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## =========================================================================</span></span></span>
<span class="r-in"><span><span class="co">## Define a function of the parameter vector: here the first component of</span></span></span>
<span class="r-in"><span><span class="co">## the "PP" parameter vector.</span></span></span>
<span class="r-in"><span><span class="co">## This is for code illustration only, since the the result can be obtained</span></span></span>
<span class="r-in"><span><span class="co">## using the 'confint' method with 'method = "proflik"', which</span></span></span>
<span class="r-in"><span><span class="co">## gives the profile-likelihood confidence intervals for each of the</span></span></span>
<span class="r-in"><span><span class="co">## three parameters.</span></span></span>
<span class="r-in"><span><span class="co">## =========================================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">numPP</span> <span class="op">&lt;-</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">myfun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">theta</span>, <span class="va">object</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">thetaStar</span> <span class="op">&lt;-</span> <span class="fu">nieve</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nieve/man/poisGP2PP.html" class="external-link">poisGP2PP</a></span><span class="op">(</span>lambda <span class="op">=</span> <span class="va">theta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                                  scale <span class="op">=</span> <span class="va">theta</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                                  shape <span class="op">=</span> <span class="va">theta</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                                  loc <span class="op">=</span> <span class="va">object</span><span class="op">$</span><span class="va">threshold</span>, deriv <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">res</span> <span class="op">&lt;-</span> <span class="va">thetaStar</span><span class="op">[</span><span class="va">numPP</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="va">grad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">thetaStar</span>, <span class="st">"gradient"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span>, <span class="va">numPP</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">res</span>, <span class="st">"gradient"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">grad</span></span></span>
<span class="r-in"><span>    <span class="va">res</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">pl</span> <span class="op">&lt;-</span> <span class="fu"><a href="profLik.html">profLik</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">object</span>, fun <span class="op">=</span> <span class="va">myfun</span>, level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.95</span>, <span class="fl">0.70</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Yves Deville.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

