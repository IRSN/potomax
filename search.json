[{"path":[]},{"path":"https://irsn.github.io/potomax/TODO.html","id":"improvements-in-the-existing-functions-and-doc","dir":"","previous_headings":"","what":"Improvements in the existing functions and doc","title":"TODO list for the potmax package","text":"Implement scale = TRUE possibility poisGP. needs care log-likelhood depend scale used several functions method, just creator poisGP. [X] Write improve summary print methods \"poisGP\" \"potData\" classes. [X] Warn AIC BIC. general context heterogeneous data, concept number observations can misleading, single “MAX” observation can weight dozens observations. AIC BIC criterion used historical information. possible solution setting number observation NA historical information. [X] Improve exchanges class \"potData\" class \"Rendata\" Renext. able simulate data, useful testing. Improve management constraints. now initial values general compliant constraints. instance constraint shape > 0.1 imposed initial value modified compliant constaints.","code":""},{"path":"https://irsn.github.io/potomax/TODO.html","id":"new-functions-or-methods","dir":"","previous_headings":"","what":"New functions or methods","title":"TODO list for the potmax package","text":"Write functions classical diagnostics threshold choice. include trace estimated shape varying threshold, along (profile-likelihood) confidence intervals. Define generalised residuals context. Note necessarily attached observations OTS block observation deserves residual can huge weight estimation. theoretical work required .","code":""},{"path":"https://irsn.github.io/potomax/TODO.html","id":"changes-in-the-classes-and-creator-functions","dir":"","previous_headings":"","what":"Changes in the classes and creator functions","title":"TODO list for the potmax package","text":"Enhance potData S3 class allowing contain optional information time events. block start end indication leading two vectors start end three parts \"OT\", \"MAX\" \"OTS\". Similarly vectors class \"Date\" \"POSIXct\" giving time events occurred. allow time plot data implemented plot.Rendata Renext. simulate method also implemented class. [X] Consistently Renext, allow data argument poisGP class \"potData\", implying arguments MAX* OTS* left missing well effDuration.","code":""},{"path":"https://irsn.github.io/potomax/TODO.html","id":"data-and-examples","dir":"","previous_headings":"","what":"Data and examples","title":"TODO list for the potmax package","text":"Attach package several datasets potData format: Garonne, venice, . fun data Potomac river:)","code":""},{"path":"https://irsn.github.io/potomax/TODO.html","id":"performance","dir":"","previous_headings":"","what":"Performance","title":"TODO list for the potmax package","text":"Write log-likelihood functions C order make faster functions/methods using profile-likelihood confint RL. [X] Re-factor Ren2gev function Renext C function potomax accepting vectors Poisson-GP parameters lambda, scale shape well block duration w returning matrix GEV \"PP\" parameters suitable number rows. function useful Bayesian framework transformation sometimes made full sequence MCMC iterates, number rows typically several thousands. [X] Write C function making transformation inverse poisGP2PP, namely: take vector PP parameters, block duration w threshold transform data vector Poisson-GP parameters. probability functions *GPD2 transformation Poisson-GP parameters PP, assumed parameters vectors different. However shape turns constant computations involving shape done repeatedly. avoided testing > 0 whether iShape zero computing.","code":""},{"path":[]},{"path":"https://irsn.github.io/potomax/articles/Intro.html","id":"scope","dir":"Articles","previous_headings":"The potomax package","what":"Scope","title":"R Package potomax: Overview","text":"potomax package financed IRSN/Behrig designed response Behrig’s practical needs Extreme-Value modelling. potomax package devoted estimation inference Poisson-GP model Extreme-Value Analysis. model marked Poisson process indexed time marks distributed according Generalised Pareto (GP) distribution. classical framework Peaks Threshold (POT) modelling (Davison Smith 1990), although Binomial-GP can also used. aggregating marks time retaining maxima largest observations given time intervals time blocks, get classical block maxima \\(r\\)-largest observations. one original features package, one can censor block maxima \\(r\\)-largest observations discard non-extreme block maxima.","code":""},{"path":"https://irsn.github.io/potomax/articles/Intro.html","id":"similarities-and-differences-with-renext","dir":"Articles","previous_headings":"The potomax package","what":"Similarities and differences with Renext","title":"R Package potomax: Overview","text":"case formerly released package Renext (Deville IRSN 2022), package potomax allows use observations aggregated time. involve standard block maxima, also historical information. potomax several major differences Renext, motivated creation new package Profile likelihood inference (Davison 2003) can used parameters return levels. GP distribution can used marks excesses. Since GP distribution distribution can called POT-stable, limitation GP harmless far interest Extreme-Value analysis. graphics based ggplot2 package (Wickham 2016), autoplot method used instead plot method. also differences plotting positions briefly discussed .","code":""},{"path":"https://irsn.github.io/potomax/articles/Intro.html","id":"model-and-parameters","dir":"Articles","previous_headings":"The potomax package","what":"Model and parameters","title":"R Package potomax: Overview","text":"Poisson-GP model describes observations random marks \\(Y_i\\) random times \\(T_i\\) following assumptions. events \\(T_i\\) form Poisson Process rate \\(\\lambda >0\\). marks \\(Y_i\\) ..d. \\(Y_i \\sim \\text{GPD}(u,\\, \\sigma, \\, \\xi)\\). marks \\(Y_i\\) independent Poisson process events. number \\(u\\) regarded given corresponds POT threshold. model can said POT-stable, select exceedances \\(Y_i> u'\\) higher threshold \\(u' > u\\), three assumptions still hold different rate \\(\\lambda_{u'}\\) different GP scale \\(\\sigma_{u'}\\). assumptions allow derivation marginal distribution -called block maxima. Consider time interval duration \\(w\\) maximum \\(M := \\max\\{Y_i\\}\\) marks \\(Y_i\\) corresponding times \\(T_i\\) interval. , atom corresponding case event occur interval, random variable \\(M\\) follows Generalised Extreme Value (GEV) distribution. Moreover consider partition time axis time intervals time blocks \\(b =1\\), \\(2\\), \\(\\dots\\) duration \\(w\\), get ..d. GEV random variables \\(M_b\\). model involves vector \\(\\boldsymbol{\\theta}\\) three parameters. Poisson-GP parameterisation uses: rate \\(\\lambda\\) time-indexed Poisson process events two parameters scale \\(\\sigma\\) shape \\(\\xi\\) GP distribution excesses \\(Y_i -u\\) threshold \\(u\\). Note \\(\\lambda\\) \\(\\sigma\\) depends threshold \\(u\\) consequently denoted \\(\\lambda_u\\) \\(\\sigma_u\\). Point Process Non-Homogeneous Point Process (NHPP) parameterisation refers reference block duration \\(w\\) uses three parameters marginal GEV distribution maximum \\(M\\) marks \\(Y_i\\) interval duration \\(w\\). parameters location \\(\\mu^\\star\\), scale \\(\\sigma^\\star\\) shape \\(\\xi^\\star\\). Since location scale depend reference duration \\(w\\), denoted \\(\\mu^\\star_{w}\\) \\(\\sigma^\\star_{w}\\). shape parameter \\(\\xi\\) \\(\\xi^\\star\\) two parameterisations, relates common tail-index two distributions GP GEV. parameter characterises common domain attraction distributions excesses block maxima. two POT parameterisations used several CRAN packages, including: evd (Stephenson 2002), ismev (Heffernan Stephenson 2012), extRemes (Gilleland Katz 2016), POT (Ribatet Dutang 2022). See also Northrop et al. (Northrop, Jonathan, Randell 2016) presentation two frameworks differences non-stationary extension using covariates.  Poisson-GP parameterisation often preferred can allow concentrate rate parameter log-likelihood, leading two-parameter optimisation instead three-parameter one. holds specific kinds censoring allowed package. Note Poisson-GP formulation can use observations exceedances threshold \\(u'\\) parameters related another “reference” threshold \\(u\\). similar NHPP parameterisation classical one-year reference block duration used observations two-year blocks. , specific parameterisation impose specific censoring needed elicit observations extreme enough. Many series annual maxima embed observations judged extreme enough POT approach. Rather aggregating annual maxima bi-annual maxima, can simply use censoring, see Venice example .","code":""},{"path":"https://irsn.github.io/potomax/articles/Intro.html","id":"creating-and-using-poisgp-objects","dir":"Articles","previous_headings":"","what":"Creating and using poisGP objects","title":"R Package potomax: Overview","text":"main class package \"PoisGP\". eponymous creator uses data formal argument can given simple numeric vector containing marks \\(Y_i\\), complex data structures \"Rendata\" Renext \"potData\" potomax, see . begin using Garonne object Renext. object contains observations discharge rate river Garonne (France) cumecs. embeds “systematic” observations “historical” observations. methods implemented classical can used many packages. Note plot method exist, autoplot instead used.  Note 12 “historical” observations plotted using different colour. classical coef method can used extract (estimated) parameters. argument type allowing choose parameterisation. parameters estimated Poisson-GP parameterisation, translated NHPP parameterisation. shape parameter parameterisations. However scale parameters differ.","code":"Garonne ## o Dataset La Garonne river flow ##    data 'Garonne', variable 'Flow' (m3/s)  ##  ## o OT data (main sample) from  1913-01-01  to  1978-01-01  (eff. dur.  65.00 years) ##   ##        n     Min.  1st Qu.   Median     Mean  3rd Qu.     Max.  ##  151.000 2530.000 2900.000 3200.000 3591.675 3995.000 7500.000  ##  ## o no missing OT periods  ##  ## o 'MAX' historical info: 1 blocks, 12 obs., total duration = 143.09 years  ##  ## o no 'OTS' historical data fitGaronne <- poisGP(data = Garonne, threshold = 2900) class(fitGaronne) ## [1] \"poisGP\" methods(class = \"poisGP\") ##  [1] AIC      autoplot BIC      coef     confint  logLik   MLE      print    ##  [9] RL       summary  vcov     ## see '?methods' for accessing help and source code autoplot(fitGaronne) coef(fitGaronne) ##       lambda        scale        shape  ##    1.7259695 1287.2134428   -0.1650405 coef(fitGaronne, type = \"PP\") ##          loc        scale        shape  ## 3571.8341138 1176.3335728   -0.1650405"},{"path":[]},{"path":"https://irsn.github.io/potomax/articles/Intro.html","id":"using-constrained-optimisations","dir":"Articles","previous_headings":"Profile likelihood","what":"Using constrained optimisations","title":"R Package potomax: Overview","text":"Profile likelihood can used infer parameters, Poisson-GP NHPP parameterisation. coef method, confint method type argument allowing switch default parameterisation \"NHPP\" one. cheap delta method can also used place profile likelihood needed. Profile likelihood can also used infer return levels returned RL method. NSGEV package, profile likelihood confidence intervals parameters potomax computed using constrained optimisations. Roughly speaking, maximise minimise parameter constraint log-likelihood high enough. precisely, \\(\\eta = \\eta(\\boldsymbol{\\theta})\\) scalar parameter interest, can find upper bound \\(\\eta_{\\text{U}}\\) confidence interval maximising parameter \\(\\eta\\) constraint \\(\\ell(\\boldsymbol{\\theta}) \\geqslant \\ell_{\\text{max}} - \\delta\\), \\(\\ell(\\boldsymbol{\\theta})\\) log-likelihood function \\(\\ell_{\\text{max}}\\) maximal value. (positive) quantity \\(\\delta\\) relates chi-square distribution one degree freedom according \\(\\delta = q_{\\chi^2(1)}(1 - \\alpha) / 2\\), \\(1 - \\alpha\\) chosen confidence level. Similarly, lower bound interval minimising \\(\\eta\\) constraint. Remind classical method used profile likelihood consists computing profile log-likelihood function \\(\\ell_{\\text{prof}}(\\eta)\\) solving numerically equation \\(\\ell_{\\text{prof}}(\\eta) = \\ell_{\\text{max}} - \\delta\\). Provided log-likelihood function well-shaped, two solutions exist: one side ML estimate \\(\\widehat{\\eta}\\). lower upper bounds confidence interval \\((\\eta_{\\text{L}}, \\, \\eta_{\\text{U}})\\). evaluation profile log-likelihood requires optimisation \\(2\\) parameters, moreover solve two equations using either zero-finding method search grid candidate values \\(\\eta\\).","code":"confint(fitGaronne) ## , , 95% ##  ##              L        U ## lambda   1.432    2.057 ## scale  991.960 1620.818 ## shape   -0.300    0.005 confint(fitGaronne, method = \"delta\") ## , , 95% ##  ##              L        U ## lambda   1.413    2.039 ## scale  971.417 1603.010 ## shape   -0.316   -0.014 confint(fitGaronne, type = \"PP\") ## , , 95% ##  ##              L        U ## loc   3333.326 3824.637 ## scale  977.466 1405.775 ## shape   -0.300    0.005"},{"path":"https://irsn.github.io/potomax/articles/Intro.html","id":"checking-the-results","dir":"Articles","previous_headings":"Profile likelihood","what":"Checking the results","title":"R Package potomax: Overview","text":"constrained optimisation method appealing generality. However, optimisation can fail misleadingly indicate convergence, can quite difficult diagnose. classical approach solving equations profile log-likelihood may also fail, yet results can checked plotting negative profile likelihood \\(-\\ell_{\\text{prof}}(\\eta)\\) parameter \\(\\eta\\), lead smooth curve minimum ML estimate \\(\\widehat{\\eta}\\). adding horizontal line corresponding negative log-likelihood ordinate \\(-(\\ell_{\\max} - \\delta)\\), confidence bounds \\(\\eta_{\\text{L}}\\) \\(\\eta_{\\text{U}}\\) abscissas two intersection points curve horizontal line. approach used several R packages including ismev, evd, extRemes POT. check implemented potomax well. RL confint methods argument check taking logical value. Using check = TRUE produce plot visual check shown . curves black, bullet required evaluation profile log-likelihood, hence two-parameter optimisation. may happen optimisation fails, leading NA. happens quite often small (negative) values shape parameter \\(\\xi\\) small values return levels corresponding small return period, say \\(T < 10\\) years. results good, can re-run (default) check = FALSE get results involving confidence intervals. Checking results confint. red vertical lines show bounds. negative log-likelihood curve horizontal red line intersect bounds. Checking confidence intervals RL. red vertical lines show bounds.","code":"autoplot(confint(fitGaronne, check = TRUE)) autoplot(RL(fitGaronne, check = TRUE))"},{"path":[]},{"path":"https://irsn.github.io/potomax/articles/Intro.html","id":"different-kinds-of-observations","dir":"Articles","previous_headings":"Heterogeneous data","what":"Different kinds of observations","title":"R Package potomax: Overview","text":"simplest use, formal argument data numeric vector giving marks \\(Y_i\\). one must also use formal argument effDuration give -called effective duration can take account possible gaps data. case estimate rate \\(\\lambda_u\\) given threshold \\(u\\) simply number \\(Y_i\\) \\(Y_i > u\\), divided effective duration. two optional arguments MAX.data OTS.data can used describe observations censored: value (Type ) number (Type II). cases, observations given list must completed numeric vector durations, MAX.effDuration OTS.effDuration. element “data” list corresponds interval time contains vector either largest observations (MAX.data) observations exceeded specific threshold (OTS.data). list must length numeric vector durations, element relating period time. “OTS” case, one must also give numeric vector thresholds OTS.threshold. Note MAX.data can used classical block maxima \\(r\\)-largest observations. MAX OTS data good practice use named lists, order keep trace period. instance names can years block maxima \\(r\\)-largest observations. vector element names used data lists, vector durations vector thresholds “OTS” case. Finally, rather using several arguments can use single structure describing heterogeneous data. aim function potData can used create object class \"potData\". object can passed data argument poisGP re-used different fits .g., different thresholds.  potData structure encapsulates several possible arguments PoisGP single object. similar done classical plot method: argument x can either vector list elements x y.  Note potData object used data argument threshold, default threshold used. chosen just smallest observation data, including data, MAX.data OTS.data, . rule applied MAX.data elements MAX.effDuration identical, fitted object compliant usual block maxima estimation: estimated parameters PP parameterisation returned classical functions estimation GEV parameters ismev::dev.fit evd:fgev. Remind however MAX.data must list, atomic vector, durations must given.","code":"G <- potData(data = Garonne$OTdata$Flow,              effDuration = 65,              MAX.data = Garonne$MAXdata$Flow,              MAX.effDuration = 143) str(G) ## List of 3 ##  $ OT :List of 4 ##   ..$ flag       : logi TRUE ##   ..$ effDuration: num 65 ##   ..$ n          : int 151 ##   ..$ data       : num [1:151] 2600 2800 2700 4579 3400 ... ##  $ MAX:List of 4 ##   ..$ flag       : logi TRUE ##   ..$ effDuration: num 143 ##   ..$ r          : int 12 ##   ..$ data       :List of 1 ##   .. ..$ MAX block#1: num [1:12] 7500 7400 7000 7000 7000 6600 6500 6500 6400 6300 ... ##  $ OTS:List of 5 ##   ..$ flag       : logi FALSE ##   ..$ effDuration: logi NA ##   ..$ r          : logi NA ##   ..$ threshold  : NULL ##   ..$ data       : NULL ##  - attr(*, \"class\")= chr \"potData\" autoplot(G) + ggtitle(\"Garonne: raw observations\") autoplot(poisGP(data = G)) + ggtitle(\"Garonne: fit with default threshold\") ## Warning in poisGP(data = G): 'threshold' is missing and set just below the ## smallest obsevation ## Warning in threshData(threshold = threshold, data, exceed = TRUE, scale = ## scale, : 'threshold' is smaller than the smallest observation ## Warning in threshData(data, threshold = threshold, exceed = FALSE, scale = ## FALSE): 'threshold' is smaller than the smallest observation"},{"path":"https://irsn.github.io/potomax/articles/Intro.html","id":"r-largest-example-venice-data","dir":"Articles","previous_headings":"Heterogeneous data","what":"\\(r\\)-largest example: Venice data","title":"R Package potomax: Overview","text":"now use Venice data ismev package, see section 3.5 Coles’ book (Coles 2001). data contain \\(r\\)-largest annual observations sea level Venice. data come matrix one row year containing \\(10\\) largest water levels (cm), possibly NA. transformations needed use poisGP function. Note first column venice must removed data since contains year. Renext potomax throw warnings set missing threshold just smallest observations order stick Poisson-GP parameterisation. classical POT, unnatural observations exceedances. order compare coefficients across packages, must use \"PP\" coefficients poisGP object rather standard \"poisGP\" coefficients. Caution comparing log-likelihoods across packages, difference may due use different constants, see ?logLik.poisGP. choose \"PP\" type log-likelihood usually makes results comparable based block maxima \\(r\\)-largest. Now profile likelihood confidence intervals parameters  written Coles, “plots indicate fundamental lack fit model”. Note smallest observations indicate neat concave curvature, largest ones seem better conform exponential tail. can investigate censoring MAX data, basis Poisson-GP model. choose threshold \\(110\\) cm corresponding ”intense” aqua alta.  fit now quite good. years observations years \\(5\\) observations , departure Poisson hypothesis often met POT. using threshold MAX.data, may happen given block (one year) observations threshold, hence discarded. case, block considered OTS.data. works even block longer contains observation correct way encode information censoring. quite subtle point explains different colour shape (green diamond) now used corresponding blocks: “MAX” blocks turned “OTS” blocks. Note provided MAX block least observation, log-likelihood OTS block threshold set smallest observations block.","code":"data(venice, package = \"ismev\") yNms <- as.character(venice[ , 1]) MAX.data <- as.list(as.data.frame(t(venice[ , -1]))) MAX.data <- lapply(MAX.data, function(x) x[!is.na(x)]) MAX.effDuration <- rep(1, length(MAX.data)) names(MAX.data) <- names(MAX.effDuration) <- yNms ## fir r-largest models fit2i <- ismev::rlarg.fit(venice[ , -1], show = FALSE) fit2R <- Renext::fGEV.MAX(MAX.data = MAX.data, MAX.effDuration = MAX.effDuration) fit2p <- poisGP(MAX.data = MAX.data, MAX.effDuration = MAX.effDuration) ## Warning in threshData(threshold = threshold, data, exceed = TRUE, scale = ## scale, : 'threshold' is smaller than the smallest observation ## Warning in threshData(data, threshold = threshold, exceed = FALSE, scale = ## FALSE): 'threshold' is smaller than the smallest observation cbind(\"ismev\" = fit2i$mle,       \"Renext\" = fit2R$estimate,       \"potomax\" = coef(fit2p, type = \"PP\")) ##             ismev      Renext     potomax ## loc   120.5479027 120.5452617 120.5459990 ## scale  12.7840265  12.7831983  12.7838900 ## shape  -0.1129418  -0.1129793  -0.1129545 cbind(\"ismev\" = -fit2i$nllh,       \"Renext\" = fit2R$loglik,       \"potomax\" = logLik(fit2p, type = \"PP\")) ##         ismev   Renext  potomax ## [1,] -1139.09 -1139.09 -1139.09 confint(fit2p) ## , , 95% ##  ##             L      U ## lambda 24.749 31.087 ## scale  16.838 20.439 ## shape  -0.133 -0.067 autoplot(fit2p) + ggtitle(\"Venice r-largest, no threshold\") fit3p <- poisGP(MAX.data = MAX.data, MAX.effDuration = MAX.effDuration, threshold = 110) coef(fit3p) ##       lambda        scale        shape  ##  1.730358874 12.916670381 -0.004969052 autoplot(fit3p) + ggtitle(\"Venice r-largest with threshold 110 cm\")"},{"path":"https://irsn.github.io/potomax/articles/Intro.html","id":"plotting-positions","dir":"Articles","previous_headings":"Heterogeneous data","what":"Plotting positions","title":"R Package potomax: Overview","text":"potomax favours log-scale axis durations RL plots, opposed Gumbel scale. allows straightforwardly show marks \\(Y_i\\). block maxima can shown plot using suitable plotting positions (Deville 2016). positions designed get points around common straight line exponential-Gumbel case \\(\\xi = 0\\), marks maxima. plotting positions derived Nelson’s plotting positions, taking account censoring needed, using method Hirsh Stedinger. marks, resulting positions close computed ppoints function default arguments, used R packages. differ -called Weibull positions used Renext. consequence, largest observations seem related larger return periods compared Renext. Mind however attaching return period largest observations prone misinterpretation. See help RP method references/links therein details plotting positions.","code":""},{"path":[]},{"path":"https://irsn.github.io/potomax/articles/Intro.html","id":"exponential-gumbel-case","dir":"Articles","previous_headings":"Special GP distribution for the excesses","what":"Exponential-Gumbel case","title":"R Package potomax: Overview","text":"version 0.2.0, possible use exponential distribution distribution excesses \\(Y_i -u\\), implying Gumbel maxima \\(M\\) time intervals. simply achieved using formal argument distName value \"exp1\", default GPD corresponding \"GPD2\". case vector parameters \\([\\lambda, \\, \\sigma]\\) (rate scale) Poisson-GP parameterisation, \\([\\mu^\\star,\\, \\sigma^\\star]\\) (loc scale) NHPP parameterisation. inference parameters similar standard case GPD exceedances.","code":"fitGaronneExp <- poisGP(data = Garonne, threshold = 3200, distName = \"exp1\") autoplot(fitGaronneExp) + ggtitle(\"Garonne with exponential excesses\") autoplot(confint(fitGaronneExp, check = TRUE))"},{"path":"https://irsn.github.io/potomax/articles/Intro.html","id":"constraints-on-parameters","dir":"Articles","previous_headings":"Special GP distribution for the excesses","what":"Constraints on parameters","title":"R Package potomax: Overview","text":"poisGP creator function two arguments coefLower coefUpper can used set bounds parameters. used estim set \"nloptr\". bounds can infinite Inf -Inf. Moreover lower upper bounds one parameter identical, parameter fixed. rule, inference misleading inequality bounds given. instance, setting bound \\(\\xi \\geqslant 0\\) corresponds using Lomax distribution excesses possible ML estimate \\(\\widehat{\\xi} = 0\\) boundary. confidence intervals generally misleading constraints used.","code":""},{"path":[]},{"path":"https://irsn.github.io/potomax/articles/Intro.html","id":"return-levels","dir":"Articles","previous_headings":"Notes and issues","what":"Return levels","title":"R Package potomax: Overview","text":"return level period \\(T\\) can equivalently considered function \\(\\rho(T;\\,\\boldsymbol{\\theta})\\) Poisson parameter \\(\\boldsymbol{\\theta}\\) function \\(\\rho^\\star(T;\\, \\boldsymbol{\\theta}^\\star)\\) PP parameter \\(\\boldsymbol{\\theta}^\\star\\). two functions take value \\(\\boldsymbol{\\theta}\\) \\(\\boldsymbol{\\theta}^\\star\\) describe model. \\(\\xi \\neq 0\\) \\[ \\underset{\\rho(T;\\,\\boldsymbol{\\theta})}{\\underbrace{% u + \\sigma_u \\, \\frac{[\\lambda_u T]^\\xi - 1}{\\xi}}} = \\underset{\\rho^\\star(T;\\,\\boldsymbol{\\theta}^\\star)}{\\underbrace{% \\mu^\\star_w + \\sigma^\\star_w \\frac{[T /w]^{\\xi^\\star} - 1}{\\xi^\\star}}}, \\] \\(\\xi = 0\\) can use log limit Box-Cox transformation. Note \\(\\rho^\\star(T)\\) given continuous duration return level, \\(T\\) small differs block duration return level} associated number \\(T/w\\) blocks duration \\(w\\). get classical return level block maxima, replace \\(q := w /T\\) \\(1 - \\log(1 - q)\\), nearly thing small \\(q\\), say \\(q < 1/50\\).","code":""},{"path":"https://irsn.github.io/potomax/articles/Intro.html","id":"log-likelihood-aic-and-bic","dir":"Articles","previous_headings":"Notes and issues","what":"Log-likelihood, AIC and BIC","title":"R Package potomax: Overview","text":"log-likelihood defined additive constant. R packages use two different constants: one block maxima, one POT without caring consistency. example using evd::fpot data two choices model = \"pp\" model = \"gpd\" get two estimates consistent re-parameterisation, yet different log-likelihoods. may difficult compare log-likelihoods across packages even within package. general framework considered potomax, concept number observations unclear, hence AIC BIC. concept number observations makes sense observations marginal distribution independent identically distributed, correspond form stationarity. framework potomax, one observation widespread time interval may informative several observations corresponding events smaller time intervals.","code":""},{"path":[]},{"path":"https://irsn.github.io/potomax/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Yves Deville. Maintainer, author.","code":""},{"path":"https://irsn.github.io/potomax/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Deville Y (2024). potomax: Peaks Threshold /Block Maxima. R package version 0.2.4, https://irsn.github.io/potomax/, https://github.com/IRSN/potomax/.","code":"@Manual{,   title = {potomax: Peaks Over Threshold and/or Block Maxima},   author = {Yves Deville},   year = {2024},   note = {R package version 0.2.4, https://irsn.github.io/potomax/},   url = {https://github.com/IRSN/potomax/}, }"},{"path":[]},{"path":"https://irsn.github.io/potomax/index.html","id":"scope","dir":"","previous_headings":"","what":"Scope","title":"Peaks Over Threshold and/or Block Maxima","text":"potomax R package funded IRSN Behrig. devoted Extreme Value analysis merges two classical approaches POT (Peaks Threshold) block MAXima. cases may consider observations related way Poisson-GP marked process .e., marked Poisson process marks following Generalised Pareto (GP) distribution. framework classical POT, also convenient block maxima arbitrary block durations. approach allows censor block maxima small considered extreme, often needed one-year blocks. also allows cope heterogeneous data met using historical information. standard case excesses follow two-parameter GP distribution, model include three parameters λ (rate Poisson process exceedances threshold u), two GP parameters σ (scale) ξ (shape). vector parameters θ = [λ, σ, ξ]⊤ can transformed vector θ⋆ = [μ⋆, σ⋆, ξ⋆]⊤ -called “Poisson-Process” (PP) parameters describe GEV distribution maximum block fixed reference duration w⋆, usually taken one year. PP parameters depend threshold u depend w⋆. Poisson-GP parameters depend w⋆ depend threshold u. shape parameters ξ ξ⋆ identical two parameterisations. often simpler use Poisson-GP parameterisation rate λ can concentrated likelihood. Poisson-GP formulation already implemented Renext package, potomax puts emphasis use profile-likelihood inference rather cheapest widespread delta method used Renext. profile-likelihood confidence intervals parameters return levels known better coverage rate based delta method. However profile-likelihood inference requires repeatedly solve optimisation problems, possible numerical issues. derivatives distribution functions w.r.t parameters provided facilitate optimisation tasks. Graphical diagnostics available check profile-likelihood results correct. package provides classical S3 methods fitted models summary, coef, logLik, confint, … also provides methods RL compute Return Levels confidence intervals, autoplot method produce “RL plots”.","code":""},{"path":"https://irsn.github.io/potomax/index.html","id":"install","dir":"","previous_headings":"","what":"Install","title":"Peaks Over Threshold and/or Block Maxima","text":"potomax versions >= 0.2.3, can rely remotes package. R session simply use install package make ready use. Note package comes vignette R Package potomax: Overview link show package help. argument build_vignettes omitted, vignette built. can also select specific branch specific commit using suitable syntax install_github, see devtools package documentation. Mind earlier versions contain compiled code hence require Windows users Rtools installed.","code":"library(remotes) install_github(\"IRSN/potomax\", dependencies = TRUE, build_vignettes = TRUE))"},{"path":"https://irsn.github.io/potomax/reference/AIC.poisGP.html","id":null,"dir":"Reference","previous_headings":"","what":"Akaike's Information Criterion and Bayesian Information\nCriterion for a Poisson-GP Object — AIC.poisGP","title":"Akaike's Information Criterion and Bayesian Information\nCriterion for a Poisson-GP Object — AIC.poisGP","text":"Akaike's Information Criterion Schwarz's Bayesian Information Criterion Poisson-GP model object.","code":""},{"path":"https://irsn.github.io/potomax/reference/AIC.poisGP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Akaike's Information Criterion and Bayesian Information\nCriterion for a Poisson-GP Object — AIC.poisGP","text":"","code":"# S3 method for poisGP AIC(object, ..., k)  # S3 method for poisGP BIC(object, ...)  # S3 method for poisGP BIC(object, ...)"},{"path":"https://irsn.github.io/potomax/reference/AIC.poisGP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Akaike's Information Criterion and Bayesian Information\nCriterion for a Poisson-GP Object — AIC.poisGP","text":"object object class \"poisGP\". ... used yet. k See AIC.","code":""},{"path":"https://irsn.github.io/potomax/reference/AIC.poisGP.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Akaike's Information Criterion and Bayesian Information\nCriterion for a Poisson-GP Object — AIC.poisGP","text":"Value criterion","code":""},{"path":"https://irsn.github.io/potomax/reference/AIC.poisGP.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Akaike's Information Criterion and Bayesian Information\nCriterion for a Poisson-GP Object — AIC.poisGP","text":"technical reasons methods type argument logLik.poisGP consequently model fitted block maxima \\(r\\)-largest computed criteria differ computed packages log-likelihoods differ constant.","code":""},{"path":"https://irsn.github.io/potomax/reference/AIC.poisGP.html","id":"caution","dir":"Reference","previous_headings":"","what":"Caution","title":"Akaike's Information Criterion and Bayesian Information\nCriterion for a Poisson-GP Object — AIC.poisGP","text":"Comparing log-likelihoods related indicators AIC, BIC across R packages can irrelevant due use different constants. Moreover concept number observations unclear heterogeneous data used. historical MAX OTS information can strong influence estimation hence can compared ordinary OT observation.","code":""},{"path":[]},{"path":"https://irsn.github.io/potomax/reference/MLE.html","id":null,"dir":"Reference","previous_headings":"","what":"Maximum-Likelihood Estimation — MLE","title":"Maximum-Likelihood Estimation — MLE","text":"MLE generic function performing Maximum-Likelihood estimation (usually incomplete) object.","code":""},{"path":"https://irsn.github.io/potomax/reference/MLE.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Maximum-Likelihood Estimation — MLE","text":"","code":"MLE(object, ...)"},{"path":"https://irsn.github.io/potomax/reference/MLE.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Maximum-Likelihood Estimation — MLE","text":"object object defining statistical model, usually incomplete estimation yet performed. ... Arguments passed methods.","code":""},{"path":"https://irsn.github.io/potomax/reference/MLE.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Maximum-Likelihood Estimation — MLE","text":"list results estimation. include estimate element, usually cov element. extracted coef vcov methods.","code":""},{"path":[]},{"path":"https://irsn.github.io/potomax/reference/MLE.poisGP.html","id":null,"dir":"Reference","previous_headings":"","what":"Maximum-Likelihood Estimation of a Poisson-GP Model — MLE.poisGP","title":"Maximum-Likelihood Estimation of a Poisson-GP Model — MLE.poisGP","text":"Maximum-Likelihood Estimation Poisson-GP model using heterogeneous data.","code":""},{"path":"https://irsn.github.io/potomax/reference/MLE.poisGP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Maximum-Likelihood Estimation of a Poisson-GP Model — MLE.poisGP","text":"","code":"# S3 method for poisGP MLE(   object = NULL,   parIni = NULL,   estim = c(\"optim\", \"nloptr\", \"eval\", \"none\"),   coefLower,   coefUpper,   parTrack = FALSE,   scale = FALSE,   trace = 0,   ... )"},{"path":"https://irsn.github.io/potomax/reference/MLE.poisGP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Maximum-Likelihood Estimation of a Poisson-GP Model — MLE.poisGP","text":"object poisGP object needs estimated. parIni Initial values parameter vector. must named vector length \\(2\\) elements names \"scale\" \"shape\". estim Type method chosen estimation. coefLower, coefUpper Lower Upper bounds parameters. numeric vectors names c(\"lambda\", \"scale\", \"shape\"). bounds GP parameters \"scale\" \"shape\" can used estimation used estim \"nloptr\". However bounds used inference confint.poisGP RL.poisGP. parTrack used yet. scale Logical. TRUE data used optimisation scaled , see threshData. IMPLEMENTED YET. trace Integer Level verbosity. ... used.","code":""},{"path":"https://irsn.github.io/potomax/reference/MLE.poisGP.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Maximum-Likelihood Estimation of a Poisson-GP Model — MLE.poisGP","text":"list results likelihood     maximisation. content list depends method     given estim, yet always contain element  logLik giving maximised log-likelihood.","code":""},{"path":"https://irsn.github.io/potomax/reference/MLE.poisGP.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Maximum-Likelihood Estimation of a Poisson-GP Model — MLE.poisGP","text":"estimation proceeds minimising concentrated (profile) negative log-likelihood depends two GPD parameters, Poisson rate. provided bounds parameter () effect estimation estimates can fail element \"lambda\" within bounds 0.0 Inf. However standard (non-profile) negative log-likelihood function built returned used derive profile-likelihood inference results.","code":""},{"path":"https://irsn.github.io/potomax/reference/MLE.poisGP.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Maximum-Likelihood Estimation of a Poisson-GP Model — MLE.poisGP","text":"Yves Deville","code":""},{"path":"https://irsn.github.io/potomax/reference/RL.html","id":null,"dir":"Reference","previous_headings":"","what":"Return Levels associated with Chosen Periods — RL","title":"Return Levels associated with Chosen Periods — RL","text":"RL generic function computes return levels associated chosen periods using suitable model data set.","code":""},{"path":"https://irsn.github.io/potomax/reference/RL.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Return Levels associated with Chosen Periods — RL","text":"","code":"RL(object, ...)"},{"path":"https://irsn.github.io/potomax/reference/RL.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Return Levels associated with Chosen Periods — RL","text":"object object can used define return levels associated period values. ... Arguments passed methods.","code":""},{"path":"https://irsn.github.io/potomax/reference/RL.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Return Levels associated with Chosen Periods — RL","text":"object inheriting \"data.frame\" class containing return levels.","code":""},{"path":"https://irsn.github.io/potomax/reference/RL.poisGP.html","id":null,"dir":"Reference","previous_headings":"","what":"Return Levels and Confidence Intervals for a Poisson-GP Model — RL.poisGP","title":"Return Levels and Confidence Intervals for a Poisson-GP Model — RL.poisGP","text":"Compute return levels along confidence bounds Poisson-GP model ML inference results.","code":""},{"path":"https://irsn.github.io/potomax/reference/RL.poisGP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Return Levels and Confidence Intervals for a Poisson-GP Model — RL.poisGP","text":"","code":"# S3 method for poisGP RL(object, period = NULL, level = 0.70,    confintMethod = c(\"proflik\", \"delta\", \"none\"),    out = c(\"data.frame\", \"array\"),    trace = 0,    check = FALSE, nCheck = 50, nSigma = 4,    ftol_abs = 1e-12, ftol_rel = 1e-9,    ...)"},{"path":"https://irsn.github.io/potomax/reference/RL.poisGP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Return Levels and Confidence Intervals for a Poisson-GP Model — RL.poisGP","text":"object object class \"poisGP\" representing inference results Poisson-GP model. period vector periods return levels computed. default \"round\" periods covering range 1 1000 chosen. level Level confidence. Can vector. confintMethod method used compute confidence intervals. value \"proflik\" corresponds profile-likelihood. value \"delta\" corresponds delta method value \"none\" can used obtain return levels without confidence limits . type outpout wanted, see Value section. trace Integer level verbosity. default value 0, confintMethod \"proflik\", good practice use trace = 1, may change future. check Logical . FALSE results intended used return-level plot, value TRUE produce results graphical check computations. nCheck Number points profile-likelihood curve value \\(T\\) return period check TRUE. points taken interval containing ML estimate \\(\\hat{\\rho}(T)\\) return level \\(\\rho(T)\\), range controled nSigma. nSigma Range return levels used build curve check TRUE. Vector length two values \\(n_1\\) \\(n_2\\) defining range values \\(\\rho(T)\\) \\(\\hat{\\rho}(T) - n_1 s(T)\\) \\(\\hat{\\rho}(T) + n_2 s(T)\\) \\(s(T)\\) estimated standard deviation \\(\\hat{\\rho}(T)\\). default choice usually covers profile-likelihood interval periods. vector length one recycled. ftol_abs, ftol_rel Absolute relative tolerance stop constrained optimisation nloptr. apply objective constrained optimisation, return level function Poisson-GP parameter vector. smallest possible values reaching convergence chosen. increasing either thes values convergence easier get results may precise wanted. can/checked using check = TRUE subsequent call autoplot. ... used yet.","code":""},{"path":"https://irsn.github.io/potomax/reference/RL.poisGP.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Return Levels and Confidence Intervals for a Poisson-GP Model — RL.poisGP","text":"check FALSE (default), object class \"RL.poisGP\" inheriting either data.frame. can also simple array containing results. first case, object can used autoplot method produce return level plot without recomputing results. check TRUE result object class RLCheck.poisGP can used autoplot build graphical check results profile-likelihood method. list containing two data frames: RL contains confidence limits estimates, negLogLik contains grid values return level \\(\\rho(T)\\) along corresponding values profile negative log-likelihood. allows plot curve.","code":""},{"path":"https://irsn.github.io/potomax/reference/RL.poisGP.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Return Levels and Confidence Intervals for a Poisson-GP Model — RL.poisGP","text":"return-level curve corresponding column dimension named \"Quant\" obtained plugging ML estimate Poisson-GP parameters quantile. confidence limits can obtained profile-likelihood standard 'delta' method.","code":""},{"path":"https://irsn.github.io/potomax/reference/RL.poisGP.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Return Levels and Confidence Intervals for a Poisson-GP Model — RL.poisGP","text":"check check = TRUE built computing value profile-likelihood period \\(T\\) candidate value \\(\\rho(T)\\). done using two-parameter optimisation: maximise vector \\([\\lambda, \\, \\xi]\\) Poisson rate \\(\\lambda\\) GP shape \\(\\xi\\), return level \\(\\rho(T)\\) fixed. optimisation can fail converge, case result NA. now derivative-free optimisation used (COBYLA): computations can quite long.","code":""},{"path":[]},{"path":"https://irsn.github.io/potomax/reference/RL.poisGP.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Return Levels and Confidence Intervals for a Poisson-GP Model — RL.poisGP","text":"Yves Deville","code":""},{"path":"https://irsn.github.io/potomax/reference/RL.poisGP.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Return Levels and Confidence Intervals for a Poisson-GP Model — RL.poisGP","text":"","code":"## ================================================================ ## Use the 'Garonne' data from Renext, which embeds both OT data ## and MAX data ## ================================================================ fitp <- poisGP(data = Garonne, threshold = 2900, trace = 2) #>  #> The data will not be scaled #>  #> Initial values for the parameter #>      lambda       scale       shape  #>    1.676923 1026.816514    0.000000  #> initial  value 927.813009  #> final  value 925.980426  #> converged #> Optimisation results #> $cvg #> [1] TRUE #>  #> $lb #> lambda  scale  shape  #>    0.0    0.0   -0.9  #>  #> $ub #> lambda  scale  shape  #>    Inf    Inf    Inf  #>  #> $df #> [1] 3 #>  #> $fit #> $fit$par #>        scale        shape  #> 1287.2134428   -0.1650405  #>  #> $fit$value #> [1] 925.9804 #>  #> $fit$counts #> function gradient  #>       18        6  #>  #> $fit$convergence #> [1] 0 #>  #> $fit$message #> NULL #>  #>  #> $estimate #>        scale        shape  #> 1287.2134428   -0.1650405  #>  #> $negLogLik #> [1] 925.9804 #>   ## ================================================================ ## RL plot with profile-likelihood confidence levels ## ================================================================ RL <- RL(fitp, out = \"data\", level = c(0.70, 0.95)) autoplot(RL)   if (FALSE) {    ## ================================================================    ## CHECK the results. Quite slow!    ## ================================================================    RLc <- RL(fitp, out = \"data\", level = c(0.70, 0.95),              check = TRUE)    autoplot(RLc) + ylim(c(NA, 540)) +        ggtitle(\"negative profile log-likelihood for rho(T)\")     ## ================================================================    ## Using values for ftol_abs or ftol_rel that are not small enough    ## we get problems in the precision of the result.    ## ================================================================     RLc <- RL(fitp, out = \"data\", level = c(0.70, 0.95), ftol_rel = 1e-5,              check = TRUE)    autoplot(RLc) + ylim(c(NA, 540)) +        ggtitle(paste(\"negative profile log-likelihood for rho(T) \",                      \" with 'ftol_rel' too large\")) }"},{"path":"https://irsn.github.io/potomax/reference/RP.html","id":null,"dir":"Reference","previous_headings":"","what":"Return Periods associated with Chosen Return Levels or\nQuantiles — RP","title":"Return Periods associated with Chosen Return Levels or\nQuantiles — RP","text":"RP generic function computes return periods associated chosen return levels quantile, using suitable model data set.","code":""},{"path":"https://irsn.github.io/potomax/reference/RP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Return Periods associated with Chosen Return Levels or\nQuantiles — RP","text":"","code":"RP(object, ...)"},{"path":"https://irsn.github.io/potomax/reference/RP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Return Periods associated with Chosen Return Levels or\nQuantiles — RP","text":"object object can used define return periods associated \"quantiles\" values. ... Arguments passed methods.","code":""},{"path":"https://irsn.github.io/potomax/reference/RP.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Return Periods associated with Chosen Return Levels or\nQuantiles — RP","text":"object inheriting \"data.frame\" class containing return periods.","code":""},{"path":"https://irsn.github.io/potomax/reference/RP.potData.html","id":null,"dir":"Reference","previous_headings":"","what":"Return Periods for a potData Object — RP.potData","title":"Return Periods for a potData Object — RP.potData","text":"Return Periods potData object.","code":""},{"path":"https://irsn.github.io/potomax/reference/RP.potData.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Return Periods for a potData Object — RP.potData","text":"","code":"# S3 method for potData RP(object, points = c(\"p\", \"H\"), a = 0.5, ...)"},{"path":"https://irsn.github.io/potomax/reference/RP.potData.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Return Periods for a potData Object — RP.potData","text":"object potData object, usually created using potData coercing object class \"Rendata\". points Type plotting positions use: ppoints code Nelson's positions. Passed ppoints value points \"p\". Ignored else. ... used yet.","code":""},{"path":"https://irsn.github.io/potomax/reference/RP.potData.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Return Periods for a potData Object — RP.potData","text":"list several elements. element data     data frame contains -called plotting positions required display observations points en     empirical return level plot. columns data include T giving return period years, S giving survival probability exceedance x return level. columns OT source keep     trace blocks observation extracted.","code":""},{"path":"https://irsn.github.io/potomax/reference/RP.potData.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Return Periods for a potData Object — RP.potData","text":"refactoring SandT function Renext package.","code":""},{"path":"https://irsn.github.io/potomax/reference/RP.potData.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Return Periods for a potData Object — RP.potData","text":"Chap. 4 Yves Deville(2020) Renext Computing Details. Tech. Report.","code":""},{"path":[]},{"path":"https://irsn.github.io/potomax/reference/RP.potData.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Return Periods for a potData Object — RP.potData","text":"","code":"pdat <- potData(data = Garonne$OTdata$Flow,                 effDuration = 65,                 MAX.data = Garonne$MAXdata$Flow,                 MAX.effDuration = 143) L <- RP(pdat)"},{"path":"https://irsn.github.io/potomax/reference/as.potData.Rendata.html","id":null,"dir":"Reference","previous_headings":"","what":"Coerce a Rendata Object — as.potData.Rendata","title":"Coerce a Rendata Object — as.potData.Rendata","text":"Coerce Rendata object object class \"potData\".","code":""},{"path":"https://irsn.github.io/potomax/reference/as.potData.Rendata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Coerce a Rendata Object — as.potData.Rendata","text":"","code":"# S3 method for Rendata as.potData(object, ...)"},{"path":"https://irsn.github.io/potomax/reference/as.potData.Rendata.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Coerce a Rendata Object — as.potData.Rendata","text":"object object S3 class \"Rendata\" package Renext. ... used now. future allow set reset names blocks using new arguments potData.","code":""},{"path":"https://irsn.github.io/potomax/reference/as.potData.Rendata.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Coerce a Rendata Object — as.potData.Rendata","text":"object S3 class \"potData\" package potomax.","code":""},{"path":"https://irsn.github.io/potomax/reference/as.potData.Rendata.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Coerce a Rendata Object — as.potData.Rendata","text":"object contains empty OTS blocks warning cast attempting find min empty block.","code":""},{"path":"https://irsn.github.io/potomax/reference/as.potData.Rendata.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Coerce a Rendata Object — as.potData.Rendata","text":"","code":"pdat <- as.potData(Garonne) pdat1 <- potData(data = Garonne$OTdata$Flow,                  effDuration = Garonne$OTinfo$effDuration,                  MAX.data = Garonne$MAXdata$Flow,                  MAX.effDuration = Garonne$MAXinfo$duration) all.equal(pdat, pdat1) #> [1] \"Component “MAX”: Component “r”: names for target but not for current\" #> [2] \"Component “MAX”: Component “data”: Names: 1 string mismatch\"           ## OTS block #2 is empty set.seed(123) rd <- rRendata(effDuration = 10,                OTS.effDuration = rep(60, 2),                OTS.threshold = rep(80, 2),                simDate = FALSE,                distname.y = \"GPD\", par.y = c(scale = 20, shape = 0.16)) d <- as.potData(rd) #> Warning: no non-missing arguments to min; returning Inf"},{"path":"https://irsn.github.io/potomax/reference/as.potData.html","id":null,"dir":"Reference","previous_headings":"","what":"Generic Coercion Function — as.potData","title":"Generic Coercion Function — as.potData","text":"Coerce object \"potData\" class representing heterogeneous data.","code":""},{"path":"https://irsn.github.io/potomax/reference/as.potData.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generic Coercion Function — as.potData","text":"","code":"as.potData(object, ...)"},{"path":"https://irsn.github.io/potomax/reference/as.potData.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generic Coercion Function — as.potData","text":"object object coerce \"potData\" class. ... passed methods.","code":""},{"path":"https://irsn.github.io/potomax/reference/as.potData.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generic Coercion Function — as.potData","text":"object clas \"potData\".","code":""},{"path":"https://irsn.github.io/potomax/reference/autolayer.potData.html","id":null,"dir":"Reference","previous_headings":"","what":"Draw a ggplot Layer for a potData Object — autolayer.potData","title":"Draw a ggplot Layer for a potData Object — autolayer.potData","text":"Draw ggplot layer potData object.","code":""},{"path":"https://irsn.github.io/potomax/reference/autolayer.potData.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Draw a ggplot Layer for a potData Object — autolayer.potData","text":"","code":"# S3 method for potData autolayer(object,          type = c(\"RLplot\", \"timeplot\"),          aes = FALSE,          xVar = c(\"T\", \"p\"),          group,          points = c(\"p\", \"H\"), a = 0.5,           ...)"},{"path":"https://irsn.github.io/potomax/reference/autolayer.potData.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Draw a ggplot Layer for a potData Object — autolayer.potData","text":"object potData object. type See autoplot.potData. aes Logical. TRUE colour, fill shape points used within aesthetic function aes wo registred appear legends. xVar See autoplot.potData. group See autoplot.potData. points, See autoplot.potData. ' \"p\". See RP.potData. ... arguments passed geom_point.","code":""},{"path":"https://irsn.github.io/potomax/reference/autolayer.potData.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Draw a ggplot Layer for a potData Object — autolayer.potData","text":"ggplot object.","code":""},{"path":"https://irsn.github.io/potomax/reference/autolayer.potData.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Draw a ggplot Layer for a potData Object — autolayer.potData","text":"aes = TRUE can needed reset scales avoid creation confusing legends. package ggnewscale can help .","code":""},{"path":[]},{"path":"https://irsn.github.io/potomax/reference/autolayer.potData.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Draw a ggplot Layer for a potData Object — autolayer.potData","text":"","code":"fit <- poisGP(data = Garonne, threshold = 2800) RL <- RL(fit) g <- autoplot(RL) g  pdat <- as.potData(Garonne) g1 <- g + autolayer(pdat, aes = TRUE) g1"},{"path":"https://irsn.github.io/potomax/reference/autoplot.RL.poisGP.html","id":null,"dir":"Reference","previous_headings":"","what":"Autoplot Method for Return Levels — autoplot.RL.poisGP","title":"Autoplot Method for Return Levels — autoplot.RL.poisGP","text":"Autoplot method objects class \"RL.poisGP\" representing table return levels.","code":""},{"path":"https://irsn.github.io/potomax/reference/autoplot.RL.poisGP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Autoplot Method for Return Levels — autoplot.RL.poisGP","text":"","code":"# S3 method for RL.poisGP autoplot(object, ...)"},{"path":"https://irsn.github.io/potomax/reference/autoplot.RL.poisGP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Autoplot Method for Return Levels — autoplot.RL.poisGP","text":"object object class \"RL.poisGP\". inherits data.frame columns containing quantiles confidence limits. ... used yet.","code":""},{"path":"https://irsn.github.io/potomax/reference/autoplot.RL.poisGP.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Autoplot Method for Return Levels — autoplot.RL.poisGP","text":"ggplot graphics object.","code":""},{"path":"https://irsn.github.io/potomax/reference/autoplot.RL.poisGPList.html","id":null,"dir":"Reference","previous_headings":"","what":"Autoplot Method for a List of Return Levels Tables — autoplot.RL.poisGPList","title":"Autoplot Method for a List of Return Levels Tables — autoplot.RL.poisGPList","text":"Autoplot list RL tables, generally using data using different data sharing observations.","code":""},{"path":"https://irsn.github.io/potomax/reference/autoplot.RL.poisGPList.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Autoplot Method for a List of Return Levels Tables — autoplot.RL.poisGPList","text":"","code":"# S3 method for RL.poisGPList autoplot(object, ...)"},{"path":"https://irsn.github.io/potomax/reference/autoplot.RL.poisGPList.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Autoplot Method for a List of Return Levels Tables — autoplot.RL.poisGPList","text":"object list Return Level tables, class \"RL.poisGPList\". ... used yet.","code":""},{"path":"https://irsn.github.io/potomax/reference/autoplot.RL.poisGPList.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Autoplot Method for a List of Return Levels Tables — autoplot.RL.poisGPList","text":"ggplot graphics object.","code":""},{"path":"https://irsn.github.io/potomax/reference/autoplot.RL.poisGPList.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Autoplot Method for a List of Return Levels Tables — autoplot.RL.poisGPList","text":"","code":"u <- seq(from = 2610, to = 3000, length.out = 4) fits <- RLs <-  list() for (iu in seq_along(u)) {     fits[[iu]] <- poisGP(data = Garonne$OTdata$Flow,                          effDuration = Garonne$OTinfo$effDuration,                          MAX.data = list(\"hist\" = Garonne$MAXdata$Flow),                          MAX.effDuration = Garonne$MAXinfo$duration,                          threshold = u[iu])     RLs[[iu]] <- RL(fits[[iu]], conf = \"prof\", out = \"data\") } names(fits) <- names(RLs) <- paste(\"thresh =\",  u)  ## force the S3 class of the result  class(RLs) <- \"RL.poisGPList\" autoplot(RLs) + theme_gray() +    ggtitle(\"Return level plots for Garonne and several thresholds\")"},{"path":"https://irsn.github.io/potomax/reference/autoplot.RLCheck.poisGP.html","id":null,"dir":"Reference","previous_headings":"","what":"Autoplot Method for RLCheck.poisGP Objects — autoplot.RLCheck.poisGP","title":"Autoplot Method for RLCheck.poisGP Objects — autoplot.RLCheck.poisGP","text":"Autoplot method objects devoted check     profile-likelihood confidence intervals return     levels Poisson-GP models.","code":""},{"path":"https://irsn.github.io/potomax/reference/autoplot.RLCheck.poisGP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Autoplot Method for RLCheck.poisGP Objects — autoplot.RLCheck.poisGP","text":"","code":"# S3 method for RLCheck.poisGP autoplot(object, ...)"},{"path":"https://irsn.github.io/potomax/reference/autoplot.RLCheck.poisGP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Autoplot Method for RLCheck.poisGP Objects — autoplot.RLCheck.poisGP","text":"object object class \"RLCheck.poisGP\" generated confint method see RL.poisGP. ... used yet.","code":""},{"path":"https://irsn.github.io/potomax/reference/autoplot.RLCheck.poisGP.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Autoplot Method for RLCheck.poisGP Objects — autoplot.RLCheck.poisGP","text":"ggplot graphics object.","code":""},{"path":"https://irsn.github.io/potomax/reference/autoplot.RLCheck.poisGP.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Autoplot Method for RLCheck.poisGP Objects — autoplot.RLCheck.poisGP","text":"object list containing two data frames named     RL negLogLikC. RL data frame     contains confidence intervals long format suitable     plotting; used draw horizontal vertical     lines showing confidence limits. negLogLikC     data frame contains evaluations profile log-likelihood     grid value return period; used     display curve parameter. check similar used confidence intervals     implemented     autoplot.confintCheck.poisGP. return level     used parameter.","code":""},{"path":[]},{"path":"https://irsn.github.io/potomax/reference/autoplot.confintCheck.poisGP.html","id":null,"dir":"Reference","previous_headings":"","what":"Autoplot Method for confintCheck.poisGP Objects — autoplot.confintCheck.poisGP","title":"Autoplot Method for confintCheck.poisGP Objects — autoplot.confintCheck.poisGP","text":"Autoplot method objects devoted check     profile-likelihood confidence intervals parameters     Poisson-GP models.","code":""},{"path":"https://irsn.github.io/potomax/reference/autoplot.confintCheck.poisGP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Autoplot Method for confintCheck.poisGP Objects — autoplot.confintCheck.poisGP","text":"","code":"# S3 method for confintCheck.poisGP autoplot(object, ...)"},{"path":"https://irsn.github.io/potomax/reference/autoplot.confintCheck.poisGP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Autoplot Method for confintCheck.poisGP Objects — autoplot.confintCheck.poisGP","text":"object object class \"confintCheck.poisGP\" generated confint method see confint.poisGP. ... used yet.","code":""},{"path":"https://irsn.github.io/potomax/reference/autoplot.confintCheck.poisGP.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Autoplot Method for confintCheck.poisGP Objects — autoplot.confintCheck.poisGP","text":"ggplot graphics object.","code":""},{"path":"https://irsn.github.io/potomax/reference/autoplot.confintCheck.poisGP.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Autoplot Method for confintCheck.poisGP Objects — autoplot.confintCheck.poisGP","text":"object list containing two data frames named ci negLogLikC. ci data frame contains confidence intervals long format suitable plotting; used draw horizontal vertical lines showing confidence limits. negLogLikC data frame contains evaluations profile log-likelihood grid value parameter; used display curve parameter. parameter, two verical lines corresponding given confidence level represent lower upper bounds confidence interval parameter. curve represent negative profiled log-likelihood considered parameter. confidence level two vertical lines intersect curve points value profiled negative log-likelhood corrresponds horizontal line level. horizontal vertical lines estimate intersect point value negative log-likelhood minimal. later condition true convergence ML estimation reached reason.","code":""},{"path":[]},{"path":"https://irsn.github.io/potomax/reference/autoplot.poisGP.html","id":null,"dir":"Reference","previous_headings":"","what":"Autoplot Method for poisGP Objects — autoplot.poisGP","title":"Autoplot Method for poisGP Objects — autoplot.poisGP","text":"Autoplot method objects representing fitted Poisson-GP models.","code":""},{"path":"https://irsn.github.io/potomax/reference/autoplot.poisGP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Autoplot Method for poisGP Objects — autoplot.poisGP","text":"","code":"# S3 method for poisGP autoplot(object,           which = c(\"RL\", \"pp\"),          level = 0.70,          points = c(\"H\", \"p\", \"none\"), a = 0.5,          allPoints = FALSE,          trace = 0,          ...)"},{"path":"https://irsn.github.io/potomax/reference/autoplot.poisGP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Autoplot Method for poisGP Objects — autoplot.poisGP","text":"object object class \"poisGP\". type plot built: \"RL\" Return Level plot \"pp\" probability plot. level Used \"RL\" passed RL.poisGP. points plotting position system used show data attached object. points \"none\", data shown. value \"H\" data shown using \"H-points\" Nelson's plotting positions. value \"p\", data shown using \"p-points\" used argument can passed ppoints function. parameter used compute plotting positions points \"p\". See RP.potData. allPoints Logical. default FALSE, limits y axis set show points threshold. value TRUE leads showing points data including threshold. trace Integer level verbosity. Passed RL.poisGP. ... used.","code":""},{"path":"https://irsn.github.io/potomax/reference/autoplot.poisGP.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Autoplot Method for poisGP Objects — autoplot.poisGP","text":"ggplot graphics object.","code":""},{"path":[]},{"path":"https://irsn.github.io/potomax/reference/autoplot.potData.html","id":null,"dir":"Reference","previous_headings":"","what":"Build ggplot Graphics for a potData Object — autoplot.potData","title":"Build ggplot Graphics for a potData Object — autoplot.potData","text":"Build ggplot graphics potData object.","code":""},{"path":"https://irsn.github.io/potomax/reference/autoplot.potData.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build ggplot Graphics for a potData Object — autoplot.potData","text":"","code":"# S3 method for potData autoplot(object,          type = c(\"RLplot\", \"timeplot\"),          aes = FALSE,          xVar = c(\"T\", \"p\"),          group,          points = c(\"p\", \"H\"), a = 0.5,          blockDuration,           ...)"},{"path":"https://irsn.github.io/potomax/reference/autoplot.potData.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Build ggplot Graphics for a potData Object — autoplot.potData","text":"object potData object. type Type plot wanted, either return-level plot time plot events shown vertical segments. implemented yet. aes Logical. TRUE colour, fill shape points used within aesthetic function aes wo registred appear legends. xVar Used type \"RLplot\". variable map absissa \\(x\\) return level plot. xVar \"T\" plotting positions computed explained Renext Computing Details. xVar = \"p\" step required probability exceedance \\(p\\) reference given block duration. group Character value \"block\" \"source\". first case color shape points depend block. second case color shape depend type source block: \"OT\", \"MAX\" \"OTS\". default value group chosen \"block\" number block small enough \"source\" otherwise. points Type plotting positions used RL plot. See RP.potData. Parameter used ppoints points \"p\". See RP.potData. blockDuration block duration used find plotting positions xVar \"p\". ... arguments passed geom_point.","code":""},{"path":"https://irsn.github.io/potomax/reference/autoplot.potData.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Build ggplot Graphics for a potData Object — autoplot.potData","text":"ggplot layer.","code":""},{"path":"https://irsn.github.io/potomax/reference/autoplot.potData.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Build ggplot Graphics for a potData Object — autoplot.potData","text":"user might change colour shape points using scale_colour_manual scale_shape_manual.","code":""},{"path":"https://irsn.github.io/potomax/reference/autoplot.potData.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Build ggplot Graphics for a potData Object — autoplot.potData","text":"Yves Deville (2020). Renext Computing Details. Technical Report.","code":""},{"path":[]},{"path":"https://irsn.github.io/potomax/reference/autoplot.potData.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Build ggplot Graphics for a potData Object — autoplot.potData","text":"","code":"pdat <- as.potData(Garonne) autoplot(pdat) + ggtitle(\"Garonne potData\")  g <- autoplot(pdat, aes = TRUE) + ggtitle(\"Garonne potData\") g  g <- g +  scale_colour_manual(values = c(\"firebrick\", \"SpringGreen\")) +        scale_shape_manual(values = c(21, 22))  ## use autolayer ggplot() + autolayer(pdat) + scale_x_log10() + theme_gray()   ## Change the label of the historical block pdat <- potData(data = Garonne$OTdata$Flow, effDuration = 65,                 MAX.data = list(\"hist\" = Garonne$MAXdata$Flow),                 MAX.effDuration = 143) autoplot(pdat, aes = TRUE)"},{"path":"https://irsn.github.io/potomax/reference/coef.poisGP.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract Model Coefficients for a Poisson-GP Object — coef.poisGP","title":"Extract Model Coefficients for a Poisson-GP Object — coef.poisGP","text":"Extract model coefficients Poisson-GP object.","code":""},{"path":"https://irsn.github.io/potomax/reference/coef.poisGP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract Model Coefficients for a Poisson-GP Object — coef.poisGP","text":"","code":"# S3 method for poisGP coef(object, type = c(\"poisGP\", \"PP\"), ...)"},{"path":"https://irsn.github.io/potomax/reference/coef.poisGP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract Model Coefficients for a Poisson-GP Object — coef.poisGP","text":"object model class \"poisGP\". type parameterisation use. \"poisGP\" standard Poisson-GP parameters used \"lambda\" Poisson rate \\(\\lambda\\), \"scale\" ... used yet.","code":""},{"path":"https://irsn.github.io/potomax/reference/coef.poisGP.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract Model Coefficients for a Poisson-GP Object — coef.poisGP","text":"numeric vector three coefficients.","code":""},{"path":"https://irsn.github.io/potomax/reference/coef.poisGP.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Extract Model Coefficients for a Poisson-GP Object — coef.poisGP","text":"type \"poisGP\" three parameters order: \"lambda\" Poisson rate \\(\\lambda\\), \"scale\" GP scale \\(\\sigma\\) \"shape\" GP shape \\(\\xi\\). type \"PP\" Point Process parameterisation used, relation block duration. three parameters order: \"loc\" location \\(\\mu\\), \"scale\" scale \\(\\sigma\\) \"shape\" shape \\(\\xi\\). define Generalised Extreme Value (GEV) distribution tail applies maximum marks time block given duration. Note \"PP\" scale differs \"poisGP\" scale location threshold, smaller .","code":""},{"path":"https://irsn.github.io/potomax/reference/coef.poisGP.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Extract Model Coefficients for a Poisson-GP Object — coef.poisGP","text":"\"poisGP\" parameters can transformed     \"PP\" parameters using     poisGP2PP function. requires giving     threshold block duration w.","code":""},{"path":"https://irsn.github.io/potomax/reference/confint.poisGP.html","id":null,"dir":"Reference","previous_headings":"","what":"Confidence Intervals for a poisGP Object — confint.poisGP","title":"Confidence Intervals for a poisGP Object — confint.poisGP","text":"Confidence intervals parameters poisGP object.","code":""},{"path":"https://irsn.github.io/potomax/reference/confint.poisGP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Confidence Intervals for a poisGP Object — confint.poisGP","text":"","code":"# S3 method for poisGP confint(object,         parm = NULL,         level = 0.95,         type = c(\"poisGP\", \"PP\"),         method = c(\"proflik\", \"delta\"),         nSigma = 4,         trace = 0,         round = TRUE,         out = c(\"array\", \"data.frame\"),         check = FALSE, nCheck = 50,         ...)"},{"path":"https://irsn.github.io/potomax/reference/confint.poisGP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Confidence Intervals for a poisGP Object — confint.poisGP","text":"object object class \"poisGP\". parm used yet. Confidence intervals computed three parameters. level Confidence level(s). type type parameterisation wanted: Poisson-GP Point-Process. method Character: \"delta\" leads simplistic delta method \"proflik\" profile-likelihood. nSigma Used check TRUE. defines interval around ML estimate profile log-likelihood evaluated order build curve allowing check results. value nSigma defines number standard deviation current parameter used. needed, asymmetric interval can defined using two numbers e.g. c(3, 5) expected confidence intervals spread right side estimates left side. trace Integer level verbosity. round Logical. TRUE confidence limits rounded small number digits. number chosen using smallest standard deviations estimated parameters. Character giving class output. default three-dimensional array dimensions: parameter, lower/upper limit, level. level length 1, using drop output remove third dimension produce matrix. \"data.frame\" gives results \"long format\". check Logical. Used method \"proflik\". TRUE function return results intended used graphical check confidence limits taking form list two data frames. first data frame contains evaluations profile-negative log-likelihood three parameters order draw profile-likelihood curves. second one contains confidence bounds \"long format\". nCheck Number evaluations profile log-likelihood check TRUE. ... arguments passed profLik method class object. arguments ftol_abs ftol_rel can modified problems met.","code":""},{"path":"https://irsn.github.io/potomax/reference/confint.poisGP.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Confidence Intervals for a poisGP Object — confint.poisGP","text":"check FALSE, array data frame containing lower upper bounds \"L\" \"U\" confidence intervals. check TRUE list two data frames given class \"confintCheck\" order use autoplot method implemented class.","code":""},{"path":"https://irsn.github.io/potomax/reference/confint.poisGP.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Confidence Intervals for a poisGP Object — confint.poisGP","text":"method finds confidence intervals three parameters chosen parameterisation: \"poisGP\" (default) \"PP\". recommended (default) method uses profile-likelihood implemented proflik.default. determination intervals relies new method based constrained optimisation: thus profiled likelihood computed , opposed usually done. profiled likelihood can computed check results using check = TRUE, zero finding used find confidence limits following classical method. check thus entirely based graphics must carefully inspected.","code":""},{"path":"https://irsn.github.io/potomax/reference/confint.poisGP.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Confidence Intervals for a poisGP Object — confint.poisGP","text":"Remind \"PP\" parameterisation depend threshold, opposed \"poisGP\" parameterisation. type = \"PP\" used investigate threshold stability full parameter vector. However confidence intervals two shape parameter: Poisson-GP \\(\\xi\\) PP \\(\\xi^\\star\\) () identical.","code":""},{"path":"https://irsn.github.io/potomax/reference/confint.poisGP.html","id":"caution","dir":"Reference","previous_headings":"","what":"Caution","title":"Confidence Intervals for a poisGP Object — confint.poisGP","text":"determination profile-likelihood intervals can fail, wise set check = TRUE use autoplot method returned object. Problems seem frequently met type = \"PP\", .e. Point-Process parameterisation used.","code":""},{"path":[]},{"path":"https://irsn.github.io/potomax/reference/confint.poisGP.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Confidence Intervals for a poisGP Object — confint.poisGP","text":"","code":"## fit from the object Garonne from Renext (class \"Rendata\") fit <- poisGP(Garonne, threshold = 2900)  ci <- confint(fit, lev = c(0.70, 0.95), trace = 1) #>  #> o Perform profile-likelihood for the \"poisGP\"  parameterisation. #>  #>  #> o Parameter  lambda  #> ******************* #>  #>  #> o Upper bound for level 70% #>     Optimisation status: 3 #>     Iterations:          86 #>     Objective value:  532.9476250 #>     Constraint check: -0.0000000 #>     gradDist:         0.0000000 #>  #>  #> o Upper bound for level 95% #>     Optimisation status: 3 #>     Iterations:          110 #>     Objective value:  534.3312574 #>     Constraint check: -0.0000000 #>     gradDist:         0.0000000 #>  #>  #> o Lower bound for level 70% #>     Optimisation status: 3 #>     Iterations:          102 #>     Objective value:  532.9476250 #>     Constraint check:  0.0000000 #>     gradDist:         0.0000000 #>  #>  #> o Lower bound for level 95% #>     Optimisation status: 3 #>     Iterations:          131 #>     Objective value:  534.3312574 #>     Constraint check:  0.0000000 #>     gradDist:         0.0000000 #>  #> o Parameter  scale  #> ******************* #>  #>  #> o Upper bound for level 70% #>     Optimisation status: 3 #>     Iterations:          590 #>     Objective value:  532.9476250 #>     Constraint check:  0.0000000 #>     gradDist:         0.0000000 #>  #>  #> o Upper bound for level 95% #>     Optimisation status: 3 #>     Iterations:          453 #>     Objective value:  534.3298829 #>     Constraint check: -0.0013745 #>     gradDist:         0.0000000 #>  #>  #> o Lower bound for level 70% #>     Optimisation status: 3 #>     Iterations:          433 #>     Objective value:  532.9476248 #>     Constraint check: -0.0000002 #>     gradDist:         0.0000000 #>  #>  #> o Lower bound for level 95% #>     Optimisation status: 3 #>     Iterations:          340 #>     Objective value:  534.3274269 #>     Constraint check: -0.0038304 #>     gradDist:         0.0000000 #>  #> o Parameter  shape  #> ******************* #>  #>  #> o Upper bound for level 70% #>     Optimisation status: 3 #>     Iterations:          428 #>     Objective value:  532.9476250 #>     Constraint check:  0.0000000 #>     gradDist:         0.0000000 #>  #>  #> o Upper bound for level 95% #>     Optimisation status: 4 #>     Iterations:          533 #>     Objective value:  534.3312574 #>     Constraint check: -0.0000000 #>     gradDist:         0.0000000 #>  #>  #> o Lower bound for level 70% #>     Optimisation status: 3 #>     Iterations:          775 #>     Objective value:  532.9476250 #>     Constraint check: -0.0000000 #>     gradDist:         0.0000000 #>  #>  #> o Lower bound for level 95% #>     Optimisation status: 3 #>     Iterations:          1068 #>     Objective value:  534.3312573 #>     Constraint check: -0.0000000 #>     gradDist:         0.0000000 #>  #> o Results for \"poisGP\" #>  #> , , 70% #>  #>                   L             U #> lambda    1.5660291    1.89628430 #> scale  1126.0956526 1459.97198151 #> shape    -0.2403859   -0.08005602 #>  #> , , 95% #>  #>                  L            U #> lambda   1.4324021 2.057372e+00 #> scale  992.2339692 1.621010e+03 #> shape   -0.2998095 4.504269e-03 #>   ## Check the results: this is quite time-consuming. if (FALSE) { cic <- confint(fit, lev = c(0.95, 0.70), check = TRUE) autoplot(cic) + theme_gray() +     ggtitle(\"Poisson-GP parameterisation\")  cicPP <- confint(fit, type = \"PP\", lev = c(0.95, 0.70), check = TRUE) autoplot(cicPP) + theme_gray() +     ggtitle(\"Point-Process (PP) parameterisation\") }"},{"path":"https://irsn.github.io/potomax/reference/logLik.poisGP.html","id":null,"dir":"Reference","previous_headings":"","what":"Log-Likelihood of a Poisson-GP Object — logLik.poisGP","title":"Log-Likelihood of a Poisson-GP Object — logLik.poisGP","text":"Log-likelihood Poisson-GP model object.","code":""},{"path":"https://irsn.github.io/potomax/reference/logLik.poisGP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Log-Likelihood of a Poisson-GP Object — logLik.poisGP","text":"","code":"# S3 method for poisGP logLik(object, type = c(\"poisGP\", \"PP\"), ...)"},{"path":"https://irsn.github.io/potomax/reference/logLik.poisGP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Log-Likelihood of a Poisson-GP Object — logLik.poisGP","text":"object object class \"poisGP\". type experimental argument make log-likelihood comparable packages/functions. See Details. ... used yet.","code":""},{"path":"https://irsn.github.io/potomax/reference/logLik.poisGP.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Log-Likelihood of a Poisson-GP Object — logLik.poisGP","text":"Value log-likelihood.","code":""},{"path":"https://irsn.github.io/potomax/reference/logLik.poisGP.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Log-Likelihood of a Poisson-GP Object — logLik.poisGP","text":"Although models block maxima \\(r\\)-largest models can considered special cases Poisson-GP model, log-likelihood computed classical Extreme-Value packages can differ constant related observation scheme. argument type aims finding results two cases results can obtained classical packages, namely: \"POT\" fits Poisson-GP representation block maxima r-largest. first case, hopefully attained choosing type \"poisGP\" second case choosing type \"PP\".","code":""},{"path":"https://irsn.github.io/potomax/reference/logLik.poisGP.html","id":"caution","dir":"Reference","previous_headings":"","what":"Caution","title":"Log-Likelihood of a Poisson-GP Object — logLik.poisGP","text":"Comparing log-likelihoods related indicators AIC, BIC across R packages can irrelevant due use different constants.","code":""},{"path":"https://irsn.github.io/potomax/reference/poisGP.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a Poisson-GP Model Object — poisGP","title":"Create a Poisson-GP Model Object — poisGP","text":"Create Poisson-GP model object, usually ML estimation.","code":""},{"path":"https://irsn.github.io/potomax/reference/poisGP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a Poisson-GP Model Object — poisGP","text":"","code":"poisGP(data = NULL, threshold, effDuration,        MAX.data = NULL, MAX.effDuration = NULL,        OTS.data = NULL, OTS.threshold = NULL, OTS.effDuration = NULL,        distName = \"GPD2\",        parIni = NULL,        estim = c(\"optim\", \"nloptr\", \"eval\", \"none\"),        coefLower = c(\"lambda\" = 0.0, \"scale\" = 0.0, \"shape\" = -0.90),        coefUpper = c(\"lambda\" = Inf, \"scale\" = Inf, \"shape\" = Inf),        scale = FALSE,        trace = 0)"},{"path":"https://irsn.github.io/potomax/reference/poisGP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a Poisson-GP Model Object — poisGP","text":"data Either vector containing observations \"main\" sample object describing heterogeneous data. second case, data can class \"potData\" (see potData) class \"Rendata\" Renext package. Mind class \"Rendata\" yet creator, random Rendata objects can created testing using rRendata. threshold main threshold commonly understood POT. effDuration effective duration observation period corresponding data. MAX.data list numeric vectors corresponding periods blocks. vector contains \\(r\\)-largest observations block, \\(r>0\\) can vary across blocks. numeric vector passed instead list, understood one MAX block. MAX.effDuration vector positive numbers giving durations MAX blocks (order). OTS.data list numeric vectors corresponding periods blocks. vector contains observations block exceeded corresponding threshold given OTS.threshold. number \\(r \\geq 0\\) vary across blocks. numeric vector passed instead list, understood one OTS block. OTS.threshold vector positive numbers giving thresholds OTS blocks (order). construction elements OTS.data[] larger OTS.threshold[] block index . OTS.effDuration vector positive numbers giving durations OTS blocks (order). distName Character name distribution used excesses threshold. now thids can \"GPD2\" corresponding GPD2, \"exp1\" corresponding Exp1. Note cases first parameter () scale parameter. parIni named parameter vector. used set values estim \"none\" provide initial values cases. parIni NULL parameter vector stored object contain NA estim \"none\" \"good\" initial values found devoted function. estim Character defining function method used maximise likelhood. See Details. coefLower, coefUpper Named vectors bounds parameters. values can infinite Inf -Inf.  However, note without bounds shape parameter \\(\\xi\\) maximum likelihood infinite obtained \\(\\xi = -1\\). Note also bounds ignored estim set \"optim\". scale Logical. TRUE observations data, MAX.data OTS.data divided common positive number order avoid numerical problems. number returned scaleData element returned list. Except numerical problems, value scale impact results estimates covariance. trace Integer level verbosity.","code":""},{"path":"https://irsn.github.io/potomax/reference/poisGP.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a Poisson-GP Model Object — poisGP","text":"list among following objects found data copy data provided data     formals MAX.* OTS.* fitData modified version data observations     exceed main threshold \\(u\\) discarded     remaining observation \\(y_i\\) replaced     corresponding excess \\(y_i - u\\). positive     observations found data vectors.","code":""},{"path":"https://irsn.github.io/potomax/reference/poisGP.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create a Poisson-GP Model Object — poisGP","text":"functions methods used maximise likelihood depends estim follows. estim = \"optim\"          classical stats::optim function used          method =\"BFGS\". derivatives used          bounds parameters given coefLower          coefUpper. estim = \"nloptr\"         nloptr::nloptr function used         \"NLOPT_LD_BFGS\" algorithm option. derivatives         used well bounds parameters, leading         \"box constraints\". bounds can used fix         value GP parameter using value         coefLower coefUpper. instance         exponential distribution can fitted using zero         value shape coefLower         coefUpper. estim = \"eval\"         optimisation performed: rate lambda         corresponding provided GP parameters computed         negative log-likelihood first derivatives         evaluated, allowing determination (putative)         covariance matrix estimates. named vector         parIni contain values         Poisson-GP parameters, valid values GP         parameters \"scale\" \"shape\".         possibility can used check results provided         packages, e.g. recompute return levels. Note         however provided parameters may         approximately maximising likelihood         corresponding results misleading. estim = \"none\"         optimisation performed. log-likelihood         negative log-likelihoods remain NA, initial values         ignored.","code":""},{"path":"https://irsn.github.io/potomax/reference/poisGP.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Create a Poisson-GP Model Object — poisGP","text":"Yves Deville","code":""},{"path":"https://irsn.github.io/potomax/reference/poisGP.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a Poisson-GP Model Object — poisGP","text":"","code":"## ===================================================================== ## Use Garonne data from Renext ## =====================================================================  fit1p <- poisGP(data = Garonne$OTdata$Flow, threshold = 2900,               effDuration = 65,               MAX.data = Garonne$MAXdata$Flow,               MAX.effDuration = 143) fit1R <- Renouv(Garonne, threshold = 2900, distname.y = \"GPD\",                 plot = FALSE)  cbind(Renext = coef(fit1R), potomax = coef(fit1p)) #>              Renext      potomax #> lambda    1.7257765    1.7260135 #> scale  1288.1036804 1287.2821401 #> shape    -0.1652691   -0.1650343  ## CAUTION when comparing log-likelihoods, see ?logLik.poisGP cbind(Renext = logLik(fit1R), potomax = logLik(fit1p)) #>         Renext   potomax #> [1,] -925.9804 -925.9749  ## ===================================================================== ## Use the 'venice' data from the 'ismev' package. Contains ## r-largest observations as a matrix with one row by year and NA. ## So some transformations are needed. Note that first ## of 'venice' must be removed, and that the 'venice' data from ## the evd package may misleadingly be used instead. ## =====================================================================  rm(venice) #> Warning: object 'venice' not found data(venice, package = \"ismev\") MAX.data <- as.list(as.data.frame(t(venice[ , -1]))) MAX.data <- lapply(MAX.data, function(x) x[!is.na(x)]) MAX.effDuration <- rep(1, length(MAX.data))  fit2i <- ismev::rlarg.fit(venice[ , -1]) #> $conv #> [1] 0 #>  #> $nllh #> [1] 1139.09 #>  #> $mle #> [1] 120.5479027  12.7840265  -0.1129418 #>  #> $se #> [1] 1.36234055 0.54944881 0.01986948 #>  fit2R <- Renext::fGEV.MAX(MAX.data = MAX.data,                           MAX.effDuration = MAX.effDuration) fit2p <- poisGP(MAX.data = MAX.data,                 MAX.effDuration = MAX.effDuration) #> Warning: 'threshold' is smaller than the smallest observation #> Warning: 'threshold' is smaller than the smallest observation  ## To compare the coefficients we must use the \"PP\" coefficients ## of the poisGP object rather than the standard \"poisGP\" ## coefficients.  cbind(\"ismev\" = fit2i$mle,       \"Renext\" = fit2R$estimate,       \"potomax\" = coef(fit2p, type = \"PP\")) #>             ismev      Renext     potomax #> loc   120.5479027 120.5452617 120.5459990 #> scale  12.7840265  12.7831983  12.7838900 #> shape  -0.1129418  -0.1129793  -0.1129545  ## CAUTION when comparing log-likelihoods, see ?logLik.poisGP ## We choose here the \"PP\" type which usually makes the result ## comparable to those based on block maxima or on r-largest.  cbind(\"ismev\" = -fit2i$nllh,        \"Renext\" = fit2R$loglik,        \"potomax\" = logLik(fit2p, type = \"PP\")) #>         ismev   Renext  potomax #> [1,] -1139.09 -1139.09 -1139.09  ## profile-likelihood confidence intervals on parameters confint(fit2p) #> , , 95% #>  #>             L      U #> lambda 24.749 31.087 #> scale  16.838 20.439 #> shape  -0.133 -0.067 #>   autoplot(fit2p) + ggtitle(\"Venice r-largest\")   ## Now censor the MAX data. This can not be done with the ## other packages  fit3p <- poisGP(MAX.data = MAX.data,                 MAX.effDuration = MAX.effDuration,                 threshold = 100) coef(fit3p) #>       lambda        scale        shape  #>  4.332673851 12.053243161  0.002246636  autoplot(fit3p) + ggtitle(\"Venice r-largest with threshold 100 cm\")   ##===================================================================== ## Use Garonne data from Renext again case \"shape = 0\", ##  (exponential / Gumbel)  ##=====================================================================  u <- 3001 fit3p <- poisGP(data = Garonne$OTdata$Flow,                 threshold = u,                 effDuration = 65,                 MAX.data = Garonne$MAXdata$Flow,                 MAX.effDuration = 143,                 distName = \"exp1\")  fit3R <- Renouv(Garonne, threshold = u, distname.y = \"exponential\",                 plot = FALSE)  ## change parametrisation from Renext (rate -> scale) ## ================================================= est <- unname(coef(fit3R)) est[2] <- 1.0 / est[2] names(est) <- c(\"lambda\", \"scale\") cbind(Renext = est, potomax = coef(fit3p)) #>            Renext     potomax #> lambda    1.53889    1.538799 #> scale  1033.68946 1034.118803  ## compare log-likelihoods CAUTION see ?logLik.poisExp ## =================================================== fit3pe <- poisGP(data = Garonne$OTdata$Flow,                  threshold = u,                  effDuration = 65,                  parIni = est[-1],                  MAX.data = Garonne$MAXdata$Flow,                  MAX.effDuration = 143,                  distName = \"exp1\",                  estim = \"eval\") #> Warning:  #> No optimisation performed. Inference results can be misleading.  cbind(Renext = logLik(fit3R), potomax = logLik(fit3pe)) #>         Renext   potomax #> [1,] -857.0064 -857.0001  ## use 'nloptr' optimisation ## ========================= fit3po <- poisGP(data = Garonne$OTdata$Flow,                  threshold = u,                  effDuration = 65,                  MAX.data = Garonne$MAXdata$Flow,                  MAX.effDuration = 143,                  distName = \"exp1\",                  estim = \"nloptr\")  ## Return levels and inference ## =========================== myRL <- RL(fit1p, trace = 0, conf = \"prof\", check = TRUE) #> Use the 'autoplot' method on the resulting object to check the profile-likelihood results. autoplot(myRL) +     ggtitle(\"prof. lik. inference on return levels\") #> Warning: Removed 554 rows containing missing values (`geom_line()`). #> Warning: Removed 554 rows containing missing values (`geom_point()`).  autoplot(RL(fit1p)) +     ggtitle(\"Return level plot (prof. lik. intervals)\")   ## confidence intervals on parameters ## ================================== ci <- confint(fit1p, check = TRUE, type = \"PP\") #> Use the 'autoplot' method on the result to check the results #> Warning: Since 'check' is TRUE, 'out' set to \"data.frame\" autoplot(ci) #> Warning: Removed 15 rows containing missing values (`geom_line()`). #> Warning: Removed 15 rows containing missing values (`geom_point()`)."},{"path":"https://irsn.github.io/potomax/reference/potData.html","id":null,"dir":"Reference","previous_headings":"","what":"Structured Data Used to Define a Poisson-GP Model — potData","title":"Structured Data Used to Define a Poisson-GP Model — potData","text":"Structured data can used define     Poisson-GP model ML estimation.","code":""},{"path":"https://irsn.github.io/potomax/reference/potData.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Structured Data Used to Define a Poisson-GP Model — potData","text":"","code":"potData(data = NULL, effDuration = NULL,         MAX.data = NULL, MAX.effDuration = NULL,         OTS.data = NULL, OTS.threshold = NULL, OTS.effDuration = NULL)"},{"path":"https://irsn.github.io/potomax/reference/potData.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Structured Data Used to Define a Poisson-GP Model — potData","text":"data numeric vector containing observations main sample. NULL, main sample assumed absent. effDuration Duration main sample. MAX.data numeric vector list numeric vectors containing observations MAX blocks. MAX.effDuration numeric vector containing durations MAX blocks. OTS.data numeric vector list numeric vectors containing observations OTS blocks. OTS.threshold numeric vector containing thresholds OTS blocks. OTS.effDuration numeric vector containing durations OTS blocks.","code":""},{"path":"https://irsn.github.io/potomax/reference/potData.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Structured Data Used to Define a Poisson-GP Model — potData","text":"object class \"potDATA\", essentially list     elements given input checked suitably named.","code":""},{"path":"https://irsn.github.io/potomax/reference/potData.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Structured Data Used to Define a Poisson-GP Model — potData","text":"opposed done Renext, 'main'     threshold used . data understood     censored using 'main' threshold.     MAX OTS blocks can later used     poisGP 'main' threshold, even     contain observations thresholds smaller     main threshold.","code":""},{"path":[]},{"path":"https://irsn.github.io/potomax/reference/potData.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Structured Data Used to Define a Poisson-GP Model — potData","text":"","code":"G <- potData(data = Garonne$OTdata$Flow,              effDuration = 65,              MAX.data = Garonne$MAXdata$Flow,              MAX.effDuration = 143) G #> $OT #> $OT$flag #> [1] TRUE #>  #> $OT$effDuration #> [1] 65 #>  #> $OT$n #> [1] 151 #>  #> $OT$data #>   [1] 2600 2800 2700 4579 3400 4774 3000 4968 3100 3995 3100 3100 4774 2600 3400 #>  [16] 3200 2800 6137 3200 4189 3200 2800 3500 3200 4579 3700 2800 4384 3700 3995 #>  [31] 4774 3600 5747 2700 3100 3100 2900 3200 6332 3100 4579 3000 4579 2700 4968 #>  [46] 3500 2600 7500 3800 2600 3200 3500 3300 3000 3700 3000 3000 2600 3000 3600 #>  [61] 2900 3700 3200 2600 3500 6137 2900 2900 4774 4774 4189 4189 3000 3500 2600 #>  [76] 3000 5757 3200 2800 2800 3000 5553 2600 3300 5553 3100 5163 2600 3200 3100 #>  [91] 3600 3500 3400 4579 3700 3200 2600 2600 2900 3600 6721 2900 3800 2700 3000 #> [106] 2800 5747 3200 3200 2900 3200 3400 4968 2700 3700 4774 2700 2800 3300 2900 #> [121] 4968 5163 3700 2600 3200 3995 2600 2530 2690 4073 2840 2550 3120 2660 2610 #> [136] 4696 3690 2840 3090 5377 3956 2940 4228 3360 3110 3975 3200 3030 4209 4482 #> [151] 3630 #>  #>  #> $MAX #> $MAX$flag #> [1] TRUE #>  #> $MAX$effDuration #> [1] 143 #>  #> $MAX$r #> [1] 12 #>  #> $MAX$data #> $MAX$data$`MAX block#1` #>  [1] 7500 7400 7000 7000 7000 6600 6500 6500 6400 6300 6300 6200 #>  #>  #>  #> $OTS #> $OTS$flag #> [1] FALSE #>  #> $OTS$effDuration #> [1] NA #>  #> $OTS$r #> [1] NA #>  #> $OTS$threshold #> NULL #>  #> $OTS$data #> NULL #>  #>  #> attr(,\"class\") #> [1] \"potData\" autoplot(G) + ggtitle(\"Garonne: return level plot\")"},{"path":"https://irsn.github.io/potomax/reference/potomax-package.html","id":null,"dir":"Reference","previous_headings":"","what":"Peaks Over Threshold and/or Block Maxima — potomax-package","title":"Peaks Over Threshold and/or Block Maxima — potomax-package","text":"Estimation inference standard Peak Threshold     (POT) models using heterogeneous data. results can     formulated relation either Poisson-GP     Point-Process formulation. classical block maxima     r-largest frameworks can coped , moreover data can     cases censored discarding observations     chosen threshold.","code":""},{"path":"https://irsn.github.io/potomax/reference/potomax-package.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Peaks Over Threshold and/or Block Maxima — potomax-package","text":"DESCRIPTION file: package yet installed build time.   Index:  package yet installed build time. Renext package focuses data can thought generated marked process called Poisson-GP. Events occur random Poisson times \\(T_i\\) event comes mark \\(Y_i\\) Generalised Pareto Distribution (GPD). marks assumed independent independent event times \\(T_i\\). process POT-stable: observations thinned selecting marks threshold \\(v\\), get new Poisson-GP process smaller rate \\(\\lambda S(v)\\) \\(S(y)\\) denotes survival function GPD; excesses \\(Y_i - v\\) follow GPD shape \\(\\xi\\) remaining . estimation inference can use heterogenous data observations necessarily couples \\(T_i,\\,Y_i]\\) can correspond time intervals called blocks.  blocks complete observations can available.  blocks called MAX partial observations: block maximum \\(r\\) largest order statistics \\(r\\) assumed given. blocks called OTS different partial observations: events mark \\(Y_i\\) exceeding block-specific threshold.  two schemes partial observation can met working historical data, OTS threshold often called perception threshold. done Renext, ML estimate parameter \\([\\lambda,\\, \\sigma, \\,\\xi]\\) general heterogenous data obtained maximising profile log-likelihood depending two GPD parameters \\(\\sigma\\) \\(\\xi\\) Poisson rate \\(\\lambda\\). optimisation two-parameter one. two major new possibilities found Renext. OTS MAX data longer assumed threshold     data \"main\" threshold, say \\(u\\). makes possible     censor block maxima \\(r\\)-largest data keeping     observations \\(> u\\). preferred method infer parameters return     levels profile likelihood. determination     confidence interval obtained using new method uses     constrained optimisation: profile-likelihood function     computed zero-finding used. methods     confint RL optional argument check     can used check profile-likelhood results     classical graphical method found extreme-value packages     like ismev extremes. Another difference Renext concerns graphics. Renext uses classical graphics graphics package, ggplot graphics produced ggplot2 package considered. means autoplot autolayer methods used classical graphics produced plot points lines. Note package allow use non-stationary Poisson-GP models.","code":""},{"path":"https://irsn.github.io/potomax/reference/potomax-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Peaks Over Threshold and/or Block Maxima — potomax-package","text":"Yves Deville [cre, aut] (<https://orcid.org/0000-0002-1233-488X>) Maintainer: Yves Deville <deville.yves@alpestat.com>","code":""},{"path":"https://irsn.github.io/potomax/reference/potomax-package.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Peaks Over Threshold and/or Block Maxima — potomax-package","text":"Yves Deville(2020) Renext Computing Details. Tech. Report.","code":""},{"path":[]},{"path":"https://irsn.github.io/potomax/reference/print.poisGP.html","id":null,"dir":"Reference","previous_headings":"","what":"Print Method for the Class ","title":"Print Method for the Class ","text":"Print object class \"poisGP\".","code":""},{"path":"https://irsn.github.io/potomax/reference/print.poisGP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print Method for the Class ","text":"","code":"# S3 method for poisGP print(x, data = c(\"none\", \"raw\", \"fit\"), ...)"},{"path":"https://irsn.github.io/potomax/reference/print.poisGP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print Method for the Class ","text":"x object class \"poisGP\". data Character. value \"raw\" lead print information raw data provided creator poisGP. value \"fit\" lead print information data used fit .e. excesses threshold. ... Passed summary.","code":""},{"path":"https://irsn.github.io/potomax/reference/print.poisGP.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print Method for the Class ","text":"Nothing.","code":""},{"path":"https://irsn.github.io/potomax/reference/print.poisGP.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Print Method for the Class ","text":"data \"fit\" \"OTS\" blocks can mentioned blocks exist raw data, MAX data. soon main threshold exceeds one observation MAX block block must turned OTS block threshold set main threshold.","code":""},{"path":"https://irsn.github.io/potomax/reference/profLik.default.html","id":null,"dir":"Reference","previous_headings":"","what":"Profile-Likelihood Inference for Fitted Parametric Model\nObjects — profLik.default","title":"Profile-Likelihood Inference for Fitted Parametric Model\nObjects — profLik.default","text":"Profile-likelihood inference fitted model objects.","code":""},{"path":"https://irsn.github.io/potomax/reference/profLik.default.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Profile-Likelihood Inference for Fitted Parametric Model\nObjects — profLik.default","text":"","code":"# S3 method for default profLik(object,         fun,         level = 0.95,         deriv = TRUE,         trace = 0,         diagno = TRUE,         ftol_abs = 1e-12, ftol_rel = 1e-8,         ...)"},{"path":"https://irsn.github.io/potomax/reference/profLik.default.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Profile-Likelihood Inference for Fitted Parametric Model\nObjects — profLik.default","text":"object fitted model object. See Details. fun function parameter vector profile-likelihood carried . function must arguments: theta vector parameters object model object; function can use velue slots object see Details. function must return list two elements names \"objective\" \"gradient\" required nloptr see Examples. needed, wrapper function can used use arguments. level Level confidence. Can length > 1. deriv Logical. TRUE, function fun assumed provide gradient vector attribute named \"gradient\" result. now deriv can TRUE, implies fun must compute gradient. trace Level verbosity; value 0 prints nothing. diagno Logical. TRUE two diagnostics returned two attributes \"diagno\" \"theta\" returned array. array attribute \"diagno\" contains return codes nloptr (named \"status\"), values objective constraint functions well value named \"gradDist\" whcih measures distance two directions two gradients: objective constraint.  array attribute \"theta\" contains value Poisson-GP parameter found maxi/minimise function fun constraint high log-likelihood. See section Note. ftol_abs, ftol_rel Absolute relative tolerance stop constrained optimisation nloptr. apply objective constrained optimisation value fun. Remind ftol_abs thus given unit fun. ... used yet.","code":""},{"path":"https://irsn.github.io/potomax/reference/profLik.default.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Profile-Likelihood Inference for Fitted Parametric Model\nObjects — profLik.default","text":"array value function corresponding Lower Upper end-points given confidence levels. array two attributes names \"diagno\" \"psi\" arrays. attributes provide information numerical optimisation values vector parameter maximised minimised function fun.","code":""},{"path":"https://irsn.github.io/potomax/reference/profLik.default.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Profile-Likelihood Inference for Fitted Parametric Model\nObjects — profLik.default","text":"Compute lower upper end-points profile-likelihood based confidence interval. (apparently new) method used relies maximising minimising function interest, say \\(\\eta(\\boldsymbol(\\theta)\\), constraint log-likelihood greater maximal log-likelihood minus positive quantity \\(\\delta\\) depending confidence level. differs usual method relies univariate zero-finding profile-likelihood function (minus constant). Remind evaluation profile requires \\(p-1\\) dimensional optimisation. major advantage, new method require re-parameterisation model. requirement method work object suitable \"slots\", .e. list suitable elements. : number p parameters, vector parNames parameter names, vector estimate ML estimates, closure negLogLikFun computing negative log-likelihood function value negLogLik minimised negative log-likelihood. requirements fulfilled poisGP objects package. result returned object$negLogLikFun \"gradient\" attribute allow use derivatives.","code":""},{"path":"https://irsn.github.io/potomax/reference/profLik.default.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Profile-Likelihood Inference for Fitted Parametric Model\nObjects — profLik.default","text":"confidence limit numerical optimisation may fail, case limit NA. Using trace = 1 can useful check optimisation. encourage user inspect set important diagnostics returned diagno = TRUE, especially attribute result named \"diagno\". optimisation status value status 1 4 indicate small changes parameter objective eventually obtained. hand, value 5 status indicates maximal number iterations reached, considered failure. constraint gradDist values small constraint must active optimum two gradients objective constraint must colinear optimum (Lagrange conditions). words optimum parameter vector must lie boundary high-likelihood region corresponding chosen confidence level.","code":""},{"path":"https://irsn.github.io/potomax/reference/profLik.default.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Profile-Likelihood Inference for Fitted Parametric Model\nObjects — profLik.default","text":"Deville Y. (2017) \"Profile-Likelihood Using Constrained Optimisation\". Unpublished Tech. Report. Johnson S.G. NLopt Nonlinear-Optimization Package. https://github.com/stevengj/nlopt. Section Return values manual NLOPT Reference.","code":""},{"path":[]},{"path":"https://irsn.github.io/potomax/reference/profLik.default.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Profile-Likelihood Inference for Fitted Parametric Model\nObjects — profLik.default","text":"Yves Deville","code":""},{"path":"https://irsn.github.io/potomax/reference/profLik.default.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Profile-Likelihood Inference for Fitted Parametric Model\nObjects — profLik.default","text":"","code":"object <- poisGP(Garonne) #> Warning: 'threshold' is missing and set just below the smallest obsevation #> Warning: 'threshold' is smaller than the smallest observation #> Warning: 'threshold' is smaller than the smallest observation  ## ========================================================================= ## Define a function of the parameter vector: here the first component of ## the \"PP\" parameter vector. ## This is for code illustration only, since the the result can be obtained ## using the 'confint' method with 'method = \"proflik\"', which ## gives the profile-likelihood confidence intervals for each of the ## three parameters. ## =========================================================================  numPP <- 2 myfun <- function(theta, object) {     thetaStar <- nieve::poisGP2PP(lambda = theta[1],                                   scale = theta[2],                                   shape = theta[3],                                   loc = object$threshold, deriv = TRUE)     res <- thetaStar[numPP]     grad <- attr(thetaStar, \"gradient\")[1, numPP, c(1, 3, 4)]     attr(res, \"gradient\") <- grad     res }  pl <- profLik(object = object, fun = myfun, level = c(0.95, 0.70))"},{"path":"https://irsn.github.io/potomax/reference/profLik.html","id":null,"dir":"Reference","previous_headings":"","what":"Profile-Likelihood Inference Method — profLik","title":"Profile-Likelihood Inference Method — profLik","text":"Profile-likelihood inference method. method finds bounds confidence interval given function parameter vector.","code":""},{"path":"https://irsn.github.io/potomax/reference/profLik.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Profile-Likelihood Inference Method — profLik","text":"","code":"profLik(object, fun, ...)"},{"path":"https://irsn.github.io/potomax/reference/profLik.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Profile-Likelihood Inference Method — profLik","text":"object object representing fitted parametric model. fun numeric function vector parameters model given object. ... arguments methods.","code":""},{"path":"https://irsn.github.io/potomax/reference/profLik.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Profile-Likelihood Inference Method — profLik","text":"result, typically numeric array containing confidence bounds.","code":""},{"path":"https://irsn.github.io/potomax/reference/profLik.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Profile-Likelihood Inference Method — profLik","text":"suitable conditions smoothness function \\(f(\\boldsymbol{\\theta})\\)) given fun, \\(\\eta := \\boldsymbol{\\theta}\\) can considered parameter model suitable re-parameterisation . makes sense use profile-likelihood method derive confidence intervals . Although different methods can used potomax package favours using optimisation \\(f(\\boldsymbol{\\theta})\\)) constraint high log-likelihood \\(\\ell(\\boldsymbol{\\theta}) \\geq \\ell_{\\textrm{max}} - \\delta\\) \\(\\delta\\) small positive value depending confidence level.","code":""},{"path":"https://irsn.github.io/potomax/reference/profLik.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Profile-Likelihood Inference Method — profLik","text":"Yves Deville","code":""},{"path":"https://irsn.github.io/potomax/reference/scale.potData.html","id":null,"dir":"Reference","previous_headings":"","what":"Scale Method for the Class ","title":"Scale Method for the Class ","text":"Method used consistently scale data slot object class \"potData\".","code":""},{"path":"https://irsn.github.io/potomax/reference/scale.potData.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Scale Method for the Class ","text":"","code":"# S3 method for potData scale(x, center = FALSE, scale = FALSE)"},{"path":"https://irsn.github.io/potomax/reference/scale.potData.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Scale Method for the Class ","text":"x potData object. center Either logical FALSE numeric value. later case, center first substracted data. scale Either logical FALSE numeric value. later case, scale data witll divided scale substraction center required.","code":""},{"path":"https://irsn.github.io/potomax/reference/scale.potData.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Scale Method for the Class ","text":"object class \"potData\" structure x data rescaled.","code":""},{"path":"https://irsn.github.io/potomax/reference/scale.potData.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Scale Method for the Class ","text":"scaling potData object can affect behaviour poisGP object fitted form . Fit results profile-likelihood results can differ expected.","code":""},{"path":"https://irsn.github.io/potomax/reference/scale.potData.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Scale Method for the Class ","text":"","code":"L <- as.potData(Garonne) L1 <- scale(L, scale = 1000)"},{"path":"https://irsn.github.io/potomax/reference/threshData.html","id":null,"dir":"Reference","previous_headings":"","what":"Select the Observations Over a Threshold within\nHeterogeneous Data provided as a potData object — threshData","title":"Select the Observations Over a Threshold within\nHeterogeneous Data provided as a potData object — threshData","text":"Select observations given threshold within heterogeneous data provided potData object. data possibly contain OT, MAX OTS blocks. data can optionally scaled using scale attached result attribute. function rather technical normally needed user.","code":""},{"path":"https://irsn.github.io/potomax/reference/threshData.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Select the Observations Over a Threshold within\nHeterogeneous Data provided as a potData object — threshData","text":"","code":"threshData(threshold = NULL, data, exceed = FALSE, scale = FALSE, warn = FALSE)"},{"path":"https://irsn.github.io/potomax/reference/threshData.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Select the Observations Over a Threshold within\nHeterogeneous Data provided as a potData object — threshData","text":"threshold \"main\" threshold used select observations block. data list elements \"OT\", \"MAX\" \"OTS\". sublist contains flag logical element data vector list numeric duration. exceed Logical. TRUE data returned contains exceedances threshold, .e. threshold substracted data. scale Logical. TRUE excesses threshold scaled dividing common \"round\" positive number. intended avoid numerical problems optimisation. Note round scaling number (power 10) always computed returned \"scale\" attribute result. Even though data scaled number can used optim function set parScale element control list. warn Logical. TRUE function warns threshold smaller observation 'data'.","code":""},{"path":"https://irsn.github.io/potomax/reference/threshData.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Select the Observations Over a Threshold within\nHeterogeneous Data provided as a potData object — threshData","text":"list comparable data observations threshold removed, related information changed. instance threshold greater observations \"MAX\" block, discarded number r changed accordingly.","code":""},{"path":"https://irsn.github.io/potomax/reference/threshData.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Select the Observations Over a Threshold within\nHeterogeneous Data provided as a potData object — threshData","text":"scale TRUE, suitable scale (positive number) chosen power 10 used divide exceedances threshold. can cases avoid numerical problems.","code":""},{"path":"https://irsn.github.io/potomax/reference/threshData.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Select the Observations Over a Threshold within\nHeterogeneous Data provided as a potData object — threshData","text":"'main' threshold can exceed threshold OTS blocks can also exceed observations MAX block data. later case MAX block turned OTS block threshold set main threshold; can non longer observations main threshold exceeds observations original MAX block.","code":""},{"path":[]},{"path":"https://irsn.github.io/potomax/reference/threshData.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Select the Observations Over a Threshold within\nHeterogeneous Data provided as a potData object — threshData","text":"","code":"set.seed(123) myData <-     potData(data = rexp(50), effDuration = 50,             MAX.effDuration = c(25, 10),             MAX.data = list(\"MAX1\" = tail(sort(rexp(20))),                             \"MAX2\" = tail(sort(rexp(12)))),             OTS.effDuration = c(30, 65, 200),             OTS.threshold = c(1.8, 3.2, 5.0),             OTS.data = list(\"OTS1\" = 1.8 + rexp(5),                             \"OTS2\" = 3.2 + rexp(3),                             \"OTS3\" = 5.0 + rexp(2)))  myData2 <- threshData(threshold = 4, data = myData) autoplot(myData)"},{"path":"https://irsn.github.io/potomax/reference/vcov.poisGP.html","id":null,"dir":"Reference","previous_headings":"","what":"Variance-Covariance Matrix  for a Poisson-GP Object — vcov.poisGP","title":"Variance-Covariance Matrix  for a Poisson-GP Object — vcov.poisGP","text":"Variance-covariance matrix Poisson-GP object.","code":""},{"path":"https://irsn.github.io/potomax/reference/vcov.poisGP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Variance-Covariance Matrix  for a Poisson-GP Object — vcov.poisGP","text":"","code":"# S3 method for poisGP vcov(object, type = c(\"poisGP\", \"PP\"), ...)"},{"path":"https://irsn.github.io/potomax/reference/vcov.poisGP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Variance-Covariance Matrix  for a Poisson-GP Object — vcov.poisGP","text":"object model class \"poisGP\". type parameterisation use. ... used yet.","code":""},{"path":"https://irsn.github.io/potomax/reference/vcov.poisGP.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Variance-Covariance Matrix  for a Poisson-GP Object — vcov.poisGP","text":"covariance matrix size three.","code":""},{"path":"https://irsn.github.io/potomax/reference/vcov.poisGP.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Variance-Covariance Matrix  for a Poisson-GP Object — vcov.poisGP","text":"correlation matrix can obtained using cov2cor result.","code":""},{"path":[]},{"path":"https://irsn.github.io/potomax/news/index.html","id":"changes-0-2-4","dir":"Changelog","previous_headings":"","what":"Changes","title":"News in version 0.2.4","text":"NAMESPACE file now generated using roxygen2. vignette edited, adding references. bibtex file potomax.bib changed add DOIs update citation packages.","code":""},{"path":[]},{"path":"https://irsn.github.io/potomax/news/index.html","id":"changes-0-2-3","dir":"Changelog","previous_headings":"","what":"Changes","title":"News in version 0.2.3","text":"GPD probability functions dGPD2, pGPD2, qGPD2 rGPD2 utility functions poisGP2PP PP2poisGP moved (changes) nieve package, available CRAN GitHub. potomax now imports functions ** nieve**. consequence compiled code used functions discarded, making package easier install least Windows users.","code":""},{"path":[]},{"path":"https://irsn.github.io/potomax/news/index.html","id":"changes-0-2-3-1","dir":"Changelog","previous_headings":"","what":"Changes","title":"News in version 0.2.3","text":"Changed dependencies.","code":""},{"path":"https://irsn.github.io/potomax/news/index.html","id":"new-in-version-021","dir":"Changelog","previous_headings":"","what":"New in version 0.2.1","title":"New in version 0.2.1","text":"New vignette: R Package potomax: Overview, including Venice example.","code":""},{"path":"https://irsn.github.io/potomax/news/index.html","id":"version-0-2-1","dir":"Changelog","previous_headings":"","what":"Version 0.2.0","title":"New in version 0.2.1","text":"one-parameter exponential distribution can now used distribution excesses. leads Gumbel-distributed block maxima. Bug fix. quantile function qGPD2 work expected lower.tail = FALSE. approximation GPD2 distribution functions ξ ≈ 0 improved. three functions dGPD2, pGPD2 qGPD2, quadratic function ξ used small ξ providing Taylor series approximation. derivatives w.r.t. parameters consistently taken functions ξ linear (gradient) constant (hessian). distribution functions now smooth functions ξ even small ξ, say ξ ≈ 10−6 less. tests devoted “small ξ” approximation added package.","code":""}]
